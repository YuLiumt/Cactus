

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Thorn Write &mdash; Cactus 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lorene" href="../Lorene/main.html" />
    <link rel="prev" title="Thorn Guide" href="../Guide/main.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Cactus
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../GetStart.html">Get Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Guide/main.html">Thorn Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Thorn Write</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a-brief-introduction-to-c">A brief introduction to C</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#variables">Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#constants">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arrays">Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="#strings">Strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#structures">Structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="#typedef">typedef</a></li>
<li class="toctree-l4"><a class="reference internal" href="#local-variable">Local Variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="#size">Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#type-casting">Type Casting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pointers">Pointers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#null-pointers">NULL Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#memory-allocation">Memory allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#passing-pointers-to-functions-in-c">Passing pointers to functions in C</a></li>
<li class="toctree-l4"><a class="reference internal" href="#return-pointer-from-functions-in-c">Return pointer from functions in C</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#operators">Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#arithmetic-operators">Arithmetic Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relational-operators">Relational Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logical-operators">Logical Operators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-i-o">File I/O</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#opening-files">Opening Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#closing-a-file">Closing a File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-a-file">Writing a File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reading-a-file">Reading a File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#library">Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#assert-h">assert.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="#math-h">math.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stdio-h">stdio.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stdlib-h">stdlib.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="#string-h">string.h</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cactus-configuration-language">Cactus Configuration Language</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-interface-ccl-file">The interface.ccl File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#implementation-name">implementation name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inheritance-relationships-between-thorns">Inheritance relationships between thorns</a></li>
<li class="toctree-l4"><a class="reference internal" href="#include-files">Include Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thorn-variables">Thorn variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#function">Function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-param-ccl-file">The param.ccl File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Inheritance relationships between thorns</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameter-type">parameter type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#name">Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#steerable">Steerable</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-schedule-ccl-file">The schedule.ccl File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#assignment-statements">Assignment Statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#schedule-blocks">Schedule Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modes">Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conditional-statements">Conditional Statements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-source-file">The Source File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compile">Compile</a></li>
<li class="toctree-l4"><a class="reference internal" href="#routines">Routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cctk-routines">CCTK Routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#utility-routines">Utility Routines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#paramcheck">ParamCheck</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#coordinate">Coordinate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#global-coordinates">Global coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cartgrid3d">CartGrid3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boundary">Boundary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#initial-data">Initial Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#timelevel">Timelevel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#numerical">Numerical</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysis">Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculation">Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#volume-integral">Volume integral</a></li>
<li class="toctree-l3"><a class="reference internal" href="#surface-integral">Surface integral</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#i-o">I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utility">Utility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#find-closest">find_closest</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Lorene/main.html">Lorene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Kranc/Kranc.html">Kranc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reference.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cactus</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Thorn Write</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/note/ThornWrite/ThornWrite.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="thorn-write">
<h1>Thorn Write<a class="headerlink" href="#thorn-write" title="Permalink to this headline">¶</a></h1>
<p>Naming Conventions:</p>
<ul class="simple">
<li><p>Thorn names must not start with the word “Cactus” (in any case).</p></li>
<li><p>Routine names have to be unique among all thorns.</p></li>
<li><p>Names of global variables have to be unique among all thorns.</p></li>
</ul>
<p>The following naming conventions are followed by the flesh and the supported Cactus arrangements. They are not compulsory.</p>
<ul class="simple">
<li><p>Parameters: lower case with words separated by an underscore. Examples: my_first_parameter.</p></li>
<li><p>Routine names and names of global variables: Prefixed by thorn name with an underscore, then capitalised words, with no spaces. Examples: MyThorn_StartUpRoutine.</p></li>
</ul>
<div class="section" id="a-brief-introduction-to-c">
<h2>A brief introduction to C<a class="headerlink" href="#a-brief-introduction-to-c" title="Permalink to this headline">¶</a></h2>
<p>C is a programming language originally developed for developing the Unix operating system. It is a low-level and powerful language, but it lacks many modern and useful constructs. C++ is a newer language, based on C, that adds many more modern programming language features that make it easier to program than C.</p>
<p>A C program should be written into one or more text files with extension “.c”.</p>
<p>A C program basically consists of the following parts:</p>
<ul class="simple">
<li><p>Preprocessor Commands</p></li>
<li><p>Functions</p></li>
<li><p>Variables</p></li>
<li><p>Statements &amp; Expressions</p></li>
<li><p>Comments</p></li>
</ul>
<div class="section" id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>A variable is nothing but a name given to a storage area that our programs can manipulate. The name of a variable can be composed of letters, digits, and the underscore character. It must begin with either a letter or an underscore. Upper and lowercase letters are distinct because C is case-sensitive.</p>
<p>Each variable in C has a specific type, which determines how much space it occupies in storage and how the bit pattern stored is interpreted.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>char</p></td>
<td><p>A single character.</p></td>
</tr>
<tr class="row-odd"><td><p>int</p></td>
<td><p>An integer.</p></td>
</tr>
<tr class="row-even"><td><p>float</p></td>
<td><p>A single-precision floating point value.</p></td>
</tr>
<tr class="row-odd"><td><p>double</p></td>
<td><p>A double-precision floating point value.</p></td>
</tr>
<tr class="row-even"><td><p>void</p></td>
<td><p>Represents the absence of type.</p></td>
</tr>
</tbody>
</table>
<p>To declare a variable you use</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">variable</span> <span class="n">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">name</span> <span class="n">of</span> <span class="n">variable</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>Variables can be initialized (assigned an initial value) in their declaration.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">variable</span> <span class="n">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">name</span> <span class="n">of</span> <span class="n">variable</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span> <span class="n">of</span> <span class="n">variable</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="constants">
<h4>Constants<a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h4>
<p>Constants refer to fixed values that the program may not alter during its execution. There are two simple ways in C to define constants</p>
<ul class="simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">#define</span></code> preprocessor.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">const</span></code> keyword.</p></li>
</ul>
<div class="section" id="the-define-preprocessor">
<h5>The #define Preprocessor<a class="headerlink" href="#the-define-preprocessor" title="Permalink to this headline">¶</a></h5>
<p>Given below is the form to use <code class="docutils literal notranslate"><span class="pre">#define</span></code> preprocessor to define a constant</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define &lt;identifier&gt; &lt;value&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="the-const-keyword">
<h5>The const Keyword<a class="headerlink" href="#the-const-keyword" title="Permalink to this headline">¶</a></h5>
<p>The word “const” in front of a type name means that the variable is constant and thus its value cannot be modified by the program. Constant variables are initialised when they are declared:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="o">&lt;</span><span class="n">variable</span> <span class="n">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">name</span> <span class="n">of</span> <span class="n">variable</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span> <span class="n">of</span> <span class="n">variable</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="arrays">
<h4>Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h4>
<p>Arrays are special variables which can hold more than one value under the same variable name, organised with an index.</p>
<p>To declare an array in C, a programmer specifies the type of the elements and the number of elements required by an array as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">arrayName</span><span class="o">&gt;</span> <span class="p">[</span> <span class="o">&lt;</span><span class="n">arraySize</span><span class="o">&gt;</span> <span class="p">];</span>
</pre></div>
</div>
<p>The arraySize must be an integer constant greater than zero and type can be any valid C data type.</p>
<div class="section" id="initializing-arrays">
<h5>Initializing Arrays<a class="headerlink" href="#initializing-arrays" title="Permalink to this headline">¶</a></h5>
<p>You can initialize an array in C either one by one or using a single statement as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">balance</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">};</span>
</pre></div>
</div>
<p>The number of values between braces { } cannot be larger than the number of elements that we declare for the array between square brackets [ ]. If you omit the size of the array, an array just big enough to hold the initialization is created.</p>
</div>
<div class="section" id="accessing-array-elements">
<h5>Accessing Array Elements<a class="headerlink" href="#accessing-array-elements" title="Permalink to this headline">¶</a></h5>
<p>An element is accessed by indexing the array name. For example</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">balance</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
</pre></div>
</div>
<p>The above statement will take the <span class="math notranslate nohighlight">\(10^{th}\)</span> element from the array and assign the value to <code class="docutils literal notranslate"><span class="pre">salary</span></code> variable.</p>
</div>
</div>
<div class="section" id="strings">
<h4>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h4>
<p>Strings are actually one-dimensional array of characters terminated by a null character ‘0’.</p>
<p>The following declaration and initialization create a string consisting of the word “Hello”. To hold the null character at the end of the array, the size of the character array containing the string is one more than the number of characters in the word “Hello”.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="n">greeting</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;H&#39;</span><span class="p">,</span> <span class="sc">&#39;e&#39;</span><span class="p">,</span> <span class="sc">&#39;l&#39;</span><span class="p">,</span> <span class="sc">&#39;l&#39;</span><span class="p">,</span> <span class="sc">&#39;o&#39;</span><span class="p">,</span> <span class="sc">&#39;\0&#39;</span><span class="p">};</span>
</pre></div>
</div>
<p>If you follow the rule of array initialization then you can write the above statement as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="n">greeting</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="structures">
<h4>Structures<a class="headerlink" href="#structures" title="Permalink to this headline">¶</a></h4>
<p>When programming, it is often convenient to have a single name with which to refer to a group of a related values. Structures provide a way of storing many different values in variables of potentially different types under the same name.</p>
<div class="section" id="defining-a-structure">
<h5>Defining a Structure<a class="headerlink" href="#defining-a-structure" title="Permalink to this headline">¶</a></h5>
<p>To define a structure, you must use the struct statement. The struct statement defines a new data type, with more than one member. The format of the struct statement is as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="o">&lt;</span><span class="n">tag</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="o">&lt;</span><span class="n">members</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Where Tag is the name of the entire type of structure and Members are the variables within the struct.</p>
</div>
<div class="section" id="accessing-structure-members">
<h5>Accessing Structure Members<a class="headerlink" href="#accessing-structure-members" title="Permalink to this headline">¶</a></h5>
<p>To access any member of a structure, we use the member access operator ‘.’.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="o">&lt;</span><span class="n">tag</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">structure_variables</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// Declare &lt;structure_variables&gt; of type &lt;tag&gt;</span>
<span class="o">&lt;</span><span class="n">structure_variables</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="n">members</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="pointers-to-structures">
<h5>Pointers to Structures<a class="headerlink" href="#pointers-to-structures" title="Permalink to this headline">¶</a></h5>
<p>You can define pointers to structures in the same way as you define pointer to any other variable</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="o">&lt;</span><span class="n">tag</span><span class="o">&gt;</span> <span class="o">*&lt;</span><span class="n">struct_pointer</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>Now, you can store the address of a structure variable in the above defined pointer variable. To find the address of a structure variable, place the ‘&amp;’; operator before the structure’s name as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">struct_pointer</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&amp;&lt;</span><span class="n">structure_variables</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>To access the members of a structure using a pointer to that structure, you must use the <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> operator as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">struct_pointer</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">&lt;</span><span class="n">members</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="typedef">
<h4>typedef<a class="headerlink" href="#typedef" title="Permalink to this headline">¶</a></h4>
<p>The C programming language provides a keyword called <code class="docutils literal notranslate"><span class="pre">typedef</span></code>, which you can use to give a type a new name.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="o">&lt;</span><span class="n">existing_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">alias_name</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="local-variable">
<h4>Local Variable<a class="headerlink" href="#local-variable" title="Permalink to this headline">¶</a></h4>
<p>Variables can be declared at any point in the code, provided that, of course, they are declared before they are used. The declaration is valid only within the local block, i.e. within the region limited by braces “{  }”.</p>
</div>
<div class="section" id="size">
<h4>Size<a class="headerlink" href="#size" title="Permalink to this headline">¶</a></h4>
<p>To get the exact size of a type or a variable on a particular platform, you can use the <code class="docutils literal notranslate"><span class="pre">sizeof</span></code> operator.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span>
<span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="type-casting">
<h4>Type Casting<a class="headerlink" href="#type-casting" title="Permalink to this headline">¶</a></h4>
<p>Converting one datatype into another is known as type casting or, type-conversion. To typecast something, simply put the type of variable you want the actual variable to act as inside parentheses in front of the actual variable.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">type_name</span><span class="p">)</span> <span class="n">expression</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>A function is simply a collection of commands that do “something”. You can either use the built-in library functions or you can create your own functions.</p>
<p>They must all be declared before there is a call to them. A function declaration tells the compiler about a function’s name, return type, and a list of arguments.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">return_type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">function_name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>A function definition provides the actual body of the function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">return_type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">function_name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Here goes your code */</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here are all the parts of a function:</p>
<ul class="simple">
<li><p><strong>Return Type</strong> - A function may return a value. The return_type is the data type of the value the function returns. Some functions perform the desired operations without returning a value. In this case, the return_type is the keyword <code class="docutils literal notranslate"><span class="pre">void</span></code>.</p></li>
<li><p><strong>Function Name</strong> - This is the actual name of the function.</p></li>
<li><p><strong>Arguments</strong> - When a function is invoked, you pass a value to the parameter. This value is referred to as actual parameter or argument. The parameter list refers to the type, order, and number of the parameters of a function.</p></li>
<li><p><strong>Function Body</strong> - The function body contains a collection of statements that define what the function does.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In C, arguments are copied by value to functions, which means that we cannot change the arguments to affect their value outside of the function. To do that, we must use pointers.</p>
</div>
</div>
<div class="section" id="pointers">
<h3>Pointers<a class="headerlink" href="#pointers" title="Permalink to this headline">¶</a></h3>
<p>As you know, every variable is a memory location and every memory location has its address defined which can be accessed using ampersand (&amp;) operator, which denotes an address in memory.</p>
<p>A pointer is a variable whose value is the address of another variable, i.e., direct address of the memory location. Like any variable or constant, you must declare a pointer before using it to store any variable address.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;</span> <span class="o">*&lt;</span><span class="n">varname</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>Here, type is the pointer’s base type; it must be a valid C data type and varname is the name of the pointer variable.</p>
<p>The cool thing is that once you can talk about the address of a variable, you’ll then be able to go to that address and retrieve the data stored in it, use the <code class="docutils literal notranslate"><span class="pre">*</span></code>. The technical name for this doing this is dereferencing the pointer.</p>
<div class="section" id="null-pointers">
<h4>NULL Pointers<a class="headerlink" href="#null-pointers" title="Permalink to this headline">¶</a></h4>
<p>It is always a good practice to assign a NULL value to a pointer variable in case you do not have an exact address to be assigned. This is done at the time of variable declaration.</p>
</div>
<div class="section" id="memory-allocation">
<h4>Memory allocation<a class="headerlink" href="#memory-allocation" title="Permalink to this headline">¶</a></h4>
<p>The function <code class="docutils literal notranslate"><span class="pre">malloc</span></code>, residing in the <em>stdlib.h</em> header file, is used to initialize pointers with memory from free store. The argument to <code class="docutils literal notranslate"><span class="pre">malloc</span></code> is the amount of memory requested (in bytes), and <code class="docutils literal notranslate"><span class="pre">malloc</span></code> gets a block of memory of that size and then returns a pointer to the block of memory allocated.</p>
<p>Since different variable types have different memory requirements, we need to get a size for the amount of memory <code class="docutils literal notranslate"><span class="pre">malloc</span></code> should return. So we need to know how to get the size of different variable types. This can be done using the keyword <code class="docutils literal notranslate"><span class="pre">sizeof</span></code>, which takes an expression and returns its size. For example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</pre></div>
</div>
<p>This code set <code class="docutils literal notranslate"><span class="pre">ptr</span></code> to point to a memory address of size int. The memory that is pointed to becomes unavailable to other programs. This means that the careful coder should free this memory at the end of its usage lest the memory be lost to the operating system for the duration of the program (this is often called a memory leak because the program is not keeping track of all of its memory). The free function returns memory to the operating system.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">free</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="passing-pointers-to-functions-in-c">
<h4>Passing pointers to functions in C<a class="headerlink" href="#passing-pointers-to-functions-in-c" title="Permalink to this headline">¶</a></h4>
<p>C programming allows passing a pointer to a function. To do so, simply declare the function parameter as a pointer type.</p>
</div>
<div class="section" id="return-pointer-from-functions-in-c">
<h4>Return pointer from functions in C<a class="headerlink" href="#return-pointer-from-functions-in-c" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h3>
<p>An operator is a symbol that tells the compiler to perform specific mathematical or logical functions.</p>
<div class="section" id="arithmetic-operators">
<h4>Arithmetic Operators<a class="headerlink" href="#arithmetic-operators" title="Permalink to this headline">¶</a></h4>
<p>The following table shows all the arithmetic operators supported by the C language.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>Adds two operands.</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>Subtracts second operand from the first.</p></td>
</tr>
<tr class="row-even"><td><p>*</p></td>
<td><p>Multiplies both operands.</p></td>
</tr>
<tr class="row-odd"><td><p>/</p></td>
<td><p>Divides numerator by de-numerator.</p></td>
</tr>
<tr class="row-even"><td><p>%</p></td>
<td><p>Modulus Operator and remainder of after an integer division.</p></td>
</tr>
<tr class="row-odd"><td><p>++</p></td>
<td><p>Increment operator increases the integer value by one.</p></td>
</tr>
<tr class="row-even"><td><p>- -</p></td>
<td><p>Decrement operator decreases the integer value by one.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="relational-operators">
<h4>Relational Operators<a class="headerlink" href="#relational-operators" title="Permalink to this headline">¶</a></h4>
<p>The following table shows all the relational operators supported by C.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 94%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>==</p></td>
<td><p>Checks if the values of two operands are equal or not. If yes, then the condition becomes true.</p></td>
</tr>
<tr class="row-odd"><td><p>!=</p></td>
<td><p>Checks if the values of two operands are equal or not. If the values are not equal, then the condition becomes true.</p></td>
</tr>
<tr class="row-even"><td><p>&gt;</p></td>
<td><p>Checks if the value of left operand is greater than the value of right operand. If yes, then the condition becomes true.</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;</p></td>
<td><p>Checks if the value of left operand is less than the value of right operand. If yes, then the condition becomes true.</p></td>
</tr>
<tr class="row-even"><td><p>&gt;=</p></td>
<td><p>Checks if the value of left operand is greater than or equal to the value of right operand. If yes, then the condition becomes true.</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;=</p></td>
<td><p>Checks if the value of left operand is less than or equal to the value of right operand. If yes, then the condition becomes true.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="logical-operators">
<h4>Logical Operators<a class="headerlink" href="#logical-operators" title="Permalink to this headline">¶</a></h4>
<p>Following table shows all the logical operators supported by C language.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&amp;&amp;</p></td>
<td><p>Called Logical AND operator.</p></td>
</tr>
<tr class="row-odd"><td><p>||</p></td>
<td><p>Called Logical OR Operator.</p></td>
</tr>
<tr class="row-even"><td><p>!</p></td>
<td><p>Called Logical NOT Operator.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="decision">
<h3>Decision<a class="headerlink" href="#decision" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">if</span></code> statement allows us to check if an expression is true or false, and execute different code according to the result.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span> <span class="n">expression</span> <span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Here goes your code */</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="cm">/* Here goes your code */</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>C programming language assumes any <strong>non-zero</strong> and <strong>non-null</strong> values as <strong>true</strong>, and if it is either <strong>zero</strong> or <strong>null</strong>, then it is assumed as <strong>false</strong> value.</p>
</div>
<p>Conditional Operator <code class="docutils literal notranslate"><span class="pre">?</span> <span class="pre">:</span></code> can be used to replace <code class="docutils literal notranslate"><span class="pre">if...else</span></code> statements. It has the following general form</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Exp1</span> <span class="o">?</span> <span class="nl">Exp2</span> <span class="p">:</span> <span class="n">Exp3</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="file-i-o">
<h3>File I/O<a class="headerlink" href="#file-i-o" title="Permalink to this headline">¶</a></h3>
<p>A file represents a sequence of bytes, regardless of it being a text file or a binary file. C programming language provides access to handle file on your storage devices.</p>
<div class="section" id="opening-files">
<h4>Opening Files<a class="headerlink" href="#opening-files" title="Permalink to this headline">¶</a></h4>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">fopen()</span></code> function to create a new file or to open an existing file. This call will initialize an object of the type <code class="docutils literal notranslate"><span class="pre">FILE</span></code>, which contains all the information necessary to control the stream. The prototype of this function call is as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
</pre></div>
</div>
<p>Here, filename is a string literal, which you will use to name your file, and access mode can have one of the following values</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 3%" />
<col style="width: 97%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>r</p></td>
<td><p>Opens an existing text file for reading purpose.</p></td>
</tr>
<tr class="row-odd"><td><p>w</p></td>
<td><p>Opens a text file for writing. If it does not exist, then a new file is created. Here your program will start writing content from the beginning of the file.</p></td>
</tr>
<tr class="row-even"><td><p>a</p></td>
<td><p>Opens a text file for writing in appending mode. If it does not exist, then a new file is created. Here your program will start appending content in the existing file content.</p></td>
</tr>
<tr class="row-odd"><td><p>r+</p></td>
<td><p>Opens a text file for both reading and writing.</p></td>
</tr>
<tr class="row-even"><td><p>w+</p></td>
<td><p>Opens a text file for both reading and writing. It first truncates the file to zero length if it exists, otherwise creates a file if it does not exist.</p></td>
</tr>
<tr class="row-odd"><td><p>a+</p></td>
<td><p>Opens a text file for both reading and writing. It creates the file if it does not exist. The reading will start from the beginning but writing can only be appended.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="closing-a-file">
<h4>Closing a File<a class="headerlink" href="#closing-a-file" title="Permalink to this headline">¶</a></h4>
<p>To close a file, use the <code class="docutils literal notranslate"><span class="pre">fclose()</span></code> function. The prototype of this function is</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fclose()</span></code> function returns zero on success, or EOF if there is an error in closing the file.</p>
</div>
<div class="section" id="writing-a-file">
<h4>Writing a File<a class="headerlink" href="#writing-a-file" title="Permalink to this headline">¶</a></h4>
<p>Following is the simplest function to write argument to a stream</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">fprintf</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">comments</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-a-file">
<h4>Reading a File<a class="headerlink" href="#reading-a-file" title="Permalink to this headline">¶</a></h4>
<p>Use <code class="docutils literal notranslate"><span class="pre">fscanf()</span></code> function to read strings from a file, but it stops reading after encountering the first space character.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">fscanf</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">buff</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="library">
<h3>Library<a class="headerlink" href="#library" title="Permalink to this headline">¶</a></h3>
<p>The C standard library provides numerous built-in functions that your program can call. To access the standard functions that comes with your compiler, you need to include a header with the <code class="docutils literal notranslate"><span class="pre">#include</span></code> directive.</p>
<div class="section" id="assert-h">
<h4>assert.h<a class="headerlink" href="#assert-h" title="Permalink to this headline">¶</a></h4>
<p>TODO</p>
</div>
<div class="section" id="math-h">
<h4>math.h<a class="headerlink" href="#math-h" title="Permalink to this headline">¶</a></h4>
<p>TODO</p>
</div>
<div class="section" id="stdio-h">
<h4>stdio.h<a class="headerlink" href="#stdio-h" title="Permalink to this headline">¶</a></h4>
<p>TODO</p>
</div>
<div class="section" id="stdlib-h">
<h4>stdlib.h<a class="headerlink" href="#stdlib-h" title="Permalink to this headline">¶</a></h4>
<p>TODO</p>
</div>
<div class="section" id="string-h">
<h4>string.h<a class="headerlink" href="#string-h" title="Permalink to this headline">¶</a></h4>
<p><em>string.h</em> is a header file that contains many functions for manipulating strings.</p>
<dl class="function">
<dt>
<code class="sig-name descname">int strcmp(const char * str1, const char * str2);</code></dt>
<dd><p>Compare two strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>str1</strong> (<em>char</em>) – C string to be compared.</p></li>
<li><p><strong>str2</strong> (<em>char</em>) – C string to be compared.</p></li>
</ul>
</dd>
<dt class="field-even">Result</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> (<em>int</em>) - the contents of both strings are equal</p></li>
<li><p><strong>&lt;0</strong> (<em>int</em>) - the first character that does not match has a lower value in ptr1 than in ptr2</p></li>
<li><p><strong>&gt;0</strong> (<em>int</em>) - the first character that does not match has a greater value in ptr1 than in ptr2</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="cactus-configuration-language">
<h2>Cactus Configuration Language<a class="headerlink" href="#cactus-configuration-language" title="Permalink to this headline">¶</a></h2>
<p>Cactus Configuration Language (CCL) files are text files which tells the flesh all it needs to know about the thorns.</p>
<p>CCL files may contain comments introduced by the hash # character, which indicates that the rest of the line is a comment. If the last non-blank character of a line in a CCL file is a backslash \, the following line is treated as a continuation of the current line.</p>
<div class="section" id="the-interface-ccl-file">
<h3>The interface.ccl File<a class="headerlink" href="#the-interface-ccl-file" title="Permalink to this headline">¶</a></h3>
<p>The interface configuration file consists of:</p>
<ul class="simple">
<li><p>A header block giving details of the thorn’s relationship with other thorns.</p></li>
<li><p>A block detailing which include files are used from other thorns, and which include files are provided by this thorn.</p></li>
<li><p>Blocks detailing aliased functions provided or used by this thorn.</p></li>
<li><p>A series of blocks listing the thorn’s global variables.</p></li>
</ul>
<div class="section" id="implementation-name">
<h4>implementation name<a class="headerlink" href="#implementation-name" title="Permalink to this headline">¶</a></h4>
<p>The implementation name is declared by a single line at the top of the file</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">implements</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The implementation name must be unique among all thorns.</p>
</div>
<div class="section" id="inheritance-relationships-between-thorns">
<h4>Inheritance relationships between thorns<a class="headerlink" href="#inheritance-relationships-between-thorns" title="Permalink to this headline">¶</a></h4>
<p>There are two relationship statements that can be used to get variables (actually groups of variables) from other implementations.</p>
<ul>
<li><p>Gets all <strong>Public</strong> variables from implementation &lt;name&gt;, and all variables that &lt;name&gt; has in turn inherited</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">Inherits</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>A thorn cannot inherit from itself. Inheritance is transitive (if A inherits from B, and B inherits from C, then A also implicitly inherits from C), but not commutative.</p>
</div></blockquote>
</li>
<li><p>Gets all <strong>Protected</strong> variables from implementation &lt;name&gt;, but, unlike inherits, it defines a transitive relation by pushing its own implementation’s <strong>Protected</strong> variables onto implementation &lt;name&gt;.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">Friend</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>A thorn cannot be its own friend. Friendship is associative, commutative and transitive (if A is a friend of B, and B is a friend of C, then A is implicitly a friend of C).</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="include-files">
<h4>Include Files<a class="headerlink" href="#include-files" title="Permalink to this headline">¶</a></h4>
<p>Cactus provides a mechanism for thorns to add code to include files which can be used by any other thorn. Such include files can contain executable source code, or header/declaration information.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">INCLUDE</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="p">[</span><span class="n">SOURCE</span><span class="o">|</span><span class="n">HEADER</span><span class="p">]</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">file_to_include</span><span class="o">&gt;</span> <span class="n">in</span> <span class="o">&lt;</span><span class="n">file_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This indicates that this thorn adds the code in &lt;file to include&gt; to the include file &lt;file name&gt;.</p>
<p>Any thorn which uses the include file must declare this in its <em>interface.ccl</em> with the line</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">USES</span> <span class="n">INCLUDE</span> <span class="p">[</span><span class="n">SOURCE</span><span class="o">|</span><span class="n">HEADER</span><span class="p">]</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">file_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If the optional <code class="docutils literal notranslate"><span class="pre">[SOURCE|HEADER]</span></code> is omitted, <code class="docutils literal notranslate"><span class="pre">HEADER</span></code> is assumed. Note that this can be dangerous, as included source code, which is incorrectly assumed to be header code, will be executed in another thorn even if the providing thorn is inactive. Thus, it is recommended to always include the optional <code class="docutils literal notranslate"><span class="pre">[SOURCE|HEADER]</span></code> specification.</p>
</div>
<div class="section" id="thorn-variables">
<h4>Thorn variables<a class="headerlink" href="#thorn-variables" title="Permalink to this headline">¶</a></h4>
<p>Cactus variables are used instead of local variables for a number of reasons:</p>
<ul class="simple">
<li><p>Cactus variables can be made visible to other thorns, allowing thorns to communicate and share data.</p></li>
<li><p>Cactus variables can be distributed and communicated among processors, allowing parallel computation.</p></li>
<li><p>A database of Cactus variables, and their attributes, is held by the flesh, and this information is used by thorns, for example, for obtaining a list of variables for checkpointing.</p></li>
</ul>
<p>Cactus variables are placed in groups with homogeneous attributes, where the attributes describe properties such as the data type, group type, dimension, ghostsize, number of timelevels, and distribution.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">access</span><span class="o">&gt;:</span><span class="p">]</span>

<span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">group_name</span><span class="o">&gt;</span><span class="p">[[</span><span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">]]</span> <span class="p">[</span><span class="n">TYPE</span><span class="o">=&lt;</span><span class="n">group_type</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">DIM</span><span class="o">=&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">TIMELEVELS</span><span class="o">=&lt;</span><span class="n">num</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">SIZE</span><span class="o">=&lt;</span><span class="n">size</span> <span class="n">in</span> <span class="n">each</span> <span class="n">direction</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">DISTRIB</span><span class="o">=&lt;</span><span class="n">distribution_type</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">GHOSTSIZE</span><span class="o">=&lt;</span><span class="n">ghostsize</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">TAGS</span><span class="o">=&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">{</span>
    <span class="o">&lt;</span><span class="n">variable_name</span><span class="o">&gt;</span><span class="p">,</span>  <span class="o">&lt;</span><span class="n">variable_name</span><span class="o">&gt;</span><span class="p">,</span>  <span class="o">&lt;</span><span class="n">variable_name</span><span class="o">&gt;</span>
<span class="p">}</span> <span class="p">[</span><span class="s">&quot;&lt;group_description&gt;&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Currently, the names of groups and variables must be distinct. The options TYPE, DIM, etc., following &lt;group name&gt; must all appear on one line.</p>
<div class="section" id="access">
<h5>Access<a class="headerlink" href="#access" title="Permalink to this headline">¶</a></h5>
<p>There are three different access levels available for variables</p>
<ul class="simple">
<li><p><strong>Public</strong>: Can be ‘inherited’ by other implementations.</p></li>
<li><p><strong>Protected</strong>: Can be shared with other implementations which declare themselves to be friends of this one.</p></li>
<li><p><strong>Private</strong>: Can only be seen by this thorn.</p></li>
</ul>
<p>By default, all groups are <strong>private</strong>, to change this, an access specification of the form <code class="docutils literal notranslate"><span class="pre">public:</span></code> or <code class="docutils literal notranslate"><span class="pre">protected:</span></code></p>
</div>
<div class="section" id="data-type">
<h5>Data Type<a class="headerlink" href="#data-type" title="Permalink to this headline">¶</a></h5>
<p>Cactus supports integer, real, complex and character variable types, in various different sizes. Normally a thorn should use the default types (<strong>CCTK_INT</strong>, <strong>CCTK_REAL</strong>, <strong>CCTK_COMPLEX</strong>) rather than explicitly setting the size, as this gives maximum portability.</p>
</div>
<div class="section" id="vector-group">
<h5>Vector Group<a class="headerlink" href="#vector-group" title="Permalink to this headline">¶</a></h5>
<p>If [number] present, indicates that this is a vector group.</p>
</div>
<div class="section" id="group-types">
<h5>Group Types<a class="headerlink" href="#group-types" title="Permalink to this headline">¶</a></h5>
<p>Groups can be either scalars, grid functions (GFs), or grid arrays.</p>
<ul class="simple">
<li><p><strong>SCALAR</strong>: This is just a single number.</p></li>
<li><p><strong>GF</strong>: This is the most common group type. A GF is an array with a specific size, set at run time in the parameter file, which is distributed across processors. All GFs have the same size, and the same number of ghostzones. Groups of GFs can also specify a dimension, and number of timelevels.</p></li>
<li><p><strong>ARRAY</strong>: This is a more general form of the GF. Each group of arrays can have a distinct size and number of ghostzones, in addition to dimension and number of timelevels. The drawback of using an array over a GF is that a lot of data about the array can only be determined by function calls, rather than the quicker methods available for GFs.</p></li>
</ul>
</div>
<div class="section" id="dim">
<h5>DIM<a class="headerlink" href="#dim" title="Permalink to this headline">¶</a></h5>
<p>DIM defines the spatial dimension of the ARRAY or GF. The default value is <code class="docutils literal notranslate"><span class="pre">DIM=3</span></code>.</p>
</div>
<div class="section" id="timelevels">
<h5>Timelevels<a class="headerlink" href="#timelevels" title="Permalink to this headline">¶</a></h5>
<p>TIMELEVELS defines the number of timelevels a group has if the group is of type ARRAY or GF, and can take any positive value. The default is one timelevel.</p>
</div>
<div class="section" id="size-and-distrib">
<h5>Size and Distrib<a class="headerlink" href="#size-and-distrib" title="Permalink to this headline">¶</a></h5>
<p>A Cactus grid function or array has a size set at runtime by parameters. This size can either be the global size of the array across all processors (<code class="docutils literal notranslate"><span class="pre">DISTRIB=DEFAULT</span></code>), or, if <code class="docutils literal notranslate"><span class="pre">DISTRIB=CONSTANT</span></code>, the specified size on each processor. If the size is split across processors, the driver thorn is responsible for assigning the size on each processor.</p>
</div>
<div class="section" id="ghost-zones">
<h5>Ghost Zones<a class="headerlink" href="#ghost-zones" title="Permalink to this headline">¶</a></h5>
<p>Cactus is based upon a distributed computing paradigm. That is, the problem domain is split into blocks, each of which is assigned to a processor. For hyperbolic and parabolic problems the blocks only need to communicate at the edges. It defaults to zero.</p>
</div>
<div class="section" id="tags">
<h5>TAGS<a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h5>
<p>TAGS defines an optional string which is used to create a set of key-value pairs associated with the group. The keys are case independent. The string (which must be deliminated by single or double quotes) is interpreted by the function <code class="docutils literal notranslate"><span class="pre">Util_TableSetFromString()</span></code>.</p>
</div>
</div>
<div class="section" id="function">
<h4>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h4>
<p>Cactus offers a mechanism for calling a function in a different thorn where you don’t need to know which thorn is actually providing the function, nor what language the function is provided in. Function aliasing is also comparatively inefficient, and should not be used in a part of your code where efficiency is important.</p>
<p>If any aliased function is to be used or provided by the thorn, then the prototype must be declared with the form:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">return_type</span><span class="o">&gt;</span> <span class="n">FUNCTION</span> <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">arg1_type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">intent1</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">&lt;return_type&gt;</span></code> must be either void, CCTK_INT, CCTK_REAL, CCTK_COMPLEX, CCTK_POINTER, or CCTK_POINTER_TO_CONST. Standard types such as int are not allowed. The keyword <code class="docutils literal notranslate"><span class="pre">SUBROUTINE</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">FUNCTION</span></code>.</p></li>
<li><p>The name of the aliased function <code class="docutils literal notranslate"><span class="pre">&lt;alias&gt;</span></code> must contain at least one uppercase and one lowercase letter and follow the C standard for function names.</p></li>
<li><p>The type of an argument, <code class="docutils literal notranslate"><span class="pre">&lt;arg*_type&gt;</span></code>, must be one of scalar types CCTK_INT, CCTK_REAL, CCTK_COMPLEX, CCTK_POINTER, CCTK_POINTER_TO_CONST, or an array or pointer type CCTK_INT ARRAY, CCTK_REAL ARRAY, CCTK_COMPLEX ARRAY, CCTK_POINTER ARRAY. The scalar types are assumed to be not modifiable. If you wish to modify an argument, then it must have intent OUT or INOUT (and hence must be either a CCTK_INT, a CCTK_REAL, or a CCTK_COMPLEX, or an array of one of these types).</p></li>
<li><p>The intent of each argument, <code class="docutils literal notranslate"><span class="pre">&lt;intent*&gt;</span></code>, must be either IN, OUT, or INOUT. The C prototype will expect an argument with intent IN to be a value and one with intent OUT or INOUT to be a pointer.</p></li>
<li><p>CCTK_STRING must appear at the end of the argument list.</p></li>
</ul>
<div class="section" id="using-an-aliased-function">
<h5>Using an Aliased Function<a class="headerlink" href="#using-an-aliased-function" title="Permalink to this headline">¶</a></h5>
<p>To use an aliased function you must first declare it in your <code class="docutils literal notranslate"><span class="pre">interface.ccl</span></code> file. Declare the prototype as, for example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* this function will be either required in your thorn by */</span>
<span class="n">REQUIRES</span> <span class="n">FUNCTION</span> <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span>
<span class="cm">/* or optionally used in your thorn by */</span>
<span class="n">USES</span> <span class="n">FUNCTION</span> <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>A prototype of this function will be available to any C routine that includes the <code class="docutils literal notranslate"><span class="pre">cctk.h</span></code> header file.</p>
</div>
<div class="section" id="providing-a-function">
<h5>Providing a Function<a class="headerlink" href="#providing-a-function" title="Permalink to this headline">¶</a></h5>
<p>To provide an aliased function you must again add the prototype to your <code class="docutils literal notranslate"><span class="pre">interface.ccl</span></code> file. A statement containing the name of the providing function and the language it is provided in, must also be given. For example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">PROVIDES</span> <span class="n">FUNCTION</span> <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span> <span class="n">WITH</span> <span class="o">&lt;</span><span class="n">provider</span><span class="o">&gt;</span> <span class="n">LANGUAGE</span> <span class="o">&lt;</span><span class="n">providing_language</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>As with the alias name, <code class="docutils literal notranslate"><span class="pre">&lt;provider&gt;</span></code> must contain at least one uppercase and one lowercase letter, and follow the C standard for function names. It is necessary to specify the language of the providing function; no default will be assumed. Currently, the only supported values of <code class="docutils literal notranslate"><span class="pre">&lt;providing_language&gt;</span></code> are C and Fortran.</p>
</div>
<div class="section" id="testing-aliased-functions">
<h5>Testing Aliased Functions<a class="headerlink" href="#testing-aliased-functions" title="Permalink to this headline">¶</a></h5>
<p>The calling thorn does not know if an aliased function is even provided by another thorn. Calling an aliased function that has not been provided, will lead to a level 0 warning message, stopping the code. In order to check if a function has been provided by some thorn, use the <code class="docutils literal notranslate"><span class="pre">CCTK_IsFunctionAliased</span></code> function described in the function reference section.</p>
</div>
</div>
</div>
<div class="section" id="the-param-ccl-file">
<h3>The param.ccl File<a class="headerlink" href="#the-param-ccl-file" title="Permalink to this headline">¶</a></h3>
<p>Parameters are the means by which the user specifies the runtime behaviour of the code. Each parameter has a data type and a name, as well as a range of allowed values and a default value. These are declared in the thorn’s <cite>param.ccl</cite> file.</p>
<p>The full specification for a parameter declaration is</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">access</span><span class="o">&gt;:</span><span class="p">]</span>

<span class="p">[</span><span class="n">EXTENDS</span><span class="o">|</span><span class="n">USES</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">parameter_type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">[[</span><span class="o">&lt;</span><span class="n">len</span><span class="o">&gt;</span><span class="p">]]</span> <span class="s">&quot;&lt;parameter_description&gt;&quot;</span> <span class="p">[</span><span class="n">AS</span> <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">STEERABLE</span><span class="o">=&lt;</span><span class="n">NEVER</span><span class="o">|</span><span class="n">ALWAYS</span><span class="o">|</span><span class="n">RECOVER</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">{</span>
    <span class="o">&lt;</span><span class="n">PARAMETER_RANGES</span><span class="o">&gt;</span>
<span class="p">}</span> <span class="o">&lt;</span><span class="n">default_value</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The options AS, STEERABLE, etc., following &lt;parameter description&gt;, must all appear in one line.</p>
<div class="section" id="id1">
<h4>Access<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>There are three access levels available for parameters:</p>
<ul class="simple">
<li><p><strong>Global</strong>: These parameters are seen by all thorns.</p></li>
<li><p><strong>Restricted</strong>: These parameters may be used by other implementations if they so desire.</p></li>
<li><p><strong>Private</strong>: These are only seen by this thorn.</p></li>
</ul>
</div>
<div class="section" id="id2">
<h4>Inheritance relationships between thorns<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>To access <strong>restricted</strong> parameters from another implementation, a line containing</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">shares</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Each of these parameters must be qualified by the initial token <strong>USES</strong> or <strong>EXTENDS</strong>, where</p>
<ul class="simple">
<li><p><strong>USES</strong>: indicates that the parameters range remains unchanged.</p></li>
<li><p><strong>EXTENDS</strong>: indicates that the parameters range is going to be extended.</p></li>
</ul>
<p>For example, the following block adds possible values to the keyword &lt;par&gt; originally defined in the implementation &lt;name&gt;, and uses the REAL parameter &lt;par&gt;.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">shares</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>

<span class="n">EXTENDS</span> <span class="n">KEYWORD</span> <span class="o">&lt;</span><span class="n">par</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="s">&quot;KEYWORD&quot;</span>   <span class="o">::</span> <span class="s">&quot;A description of the parameter&quot;</span>
<span class="p">}</span>

<span class="n">USES</span> <span class="n">CCTK_REAL</span> <span class="o">&lt;</span><span class="n">par</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Note that you must compile at least one thorn which implements &lt;name&gt;.</p>
</div>
<div class="section" id="parameter-type">
<h4>parameter type<a class="headerlink" href="#parameter-type" title="Permalink to this headline">¶</a></h4>
<p>Parameters can be of these types:</p>
<ul>
<li><p><strong>CCTK_INT</strong>: Can take any integral value</p>
<blockquote>
<div><p>The range specification is of the form</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>INT &lt;par&gt; &quot;A description of the parameter&quot;
{
    \\ Each range may have a description associated with it by placing a ``::`` on the line, and putting the description afterwards.
    lower:upper:stride :: &quot;Describing the allowed values of the parameter. lower and upper specify the lower and upper allowed range, and stride allows numbers to be missed out. A missing end of range (or a `*`) indicates negative or positive infinity.&quot;
} &lt;default value&gt;
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><strong>CCTK_REAL</strong>: Can take any floating point value</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span>REAL &lt;par&gt; &quot;A description of the parameter&quot;
{
    \\ Each range may have a description associated with it by placing a ``::`` on the line, and putting the description afterwards.
    lower:upper :: &quot;Describing the allowed values of the parameter. lower and upper specify the lower and upper allowed range. A missing end of range (or a `*`) implies negative or positive infinity. &quot;
} &lt;default value&gt;
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>CCTK_KEYWORD: A distinct string with only a few known allowed values.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">KEYWORD</span> <span class="o">&lt;</span><span class="n">par</span><span class="o">&gt;</span> <span class="s">&quot;A description of the parameter&quot;</span>
<span class="p">{</span>
    <span class="s">&quot;KEYWORD_1&quot;</span>   <span class="o">::</span> <span class="s">&quot;A description of the parameter&quot;</span>
    <span class="s">&quot;KEYWORD_2&quot;</span>   <span class="o">::</span> <span class="s">&quot;A description of the parameter&quot;</span>
    <span class="s">&quot;KEYWORD_3&quot;</span>   <span class="o">::</span> <span class="s">&quot;A description of the parameter&quot;</span>
<span class="p">}</span> <span class="o">&lt;</span><span class="k">default</span> <span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>CCTK_STRING: An arbitrary string, which must conform to a given regular expression. To allow any string, the regular expression “” should be used. Regular expressions and string values should be enclosed in double quotes.</p></li>
<li><p>CCTK_BOOLEAN: A boolean type which can take values 1, t, true, yes or 0, f, false, no.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">BOOLEAN</span> <span class="o">&lt;</span><span class="n">par</span><span class="o">&gt;</span> <span class="s">&quot;A description of the parameter&quot;</span>
<span class="p">{</span>
<span class="p">}</span> <span class="o">&lt;</span><span class="k">default</span> <span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="name">
<h4>Name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h4>
<p>The &lt;parameter name&gt; must be unique within the scope of the thorn. &lt;len&gt; indicates that this is an array parameter of len values of the specified type. &lt;alias&gt; allows a parameter to appear under a different name in this thorn, other than its original name in another thorn.</p>
</div>
<div class="section" id="steerable">
<h4>Steerable<a class="headerlink" href="#steerable" title="Permalink to this headline">¶</a></h4>
<p>By default, parameters may not be changed after the parameter file has been read, or on restarting from checkpoint. A parameter can be changed dynamically if it is specified to be steerable. It can then be changed by a call to the flesh function <code class="docutils literal notranslate"><span class="pre">CCTK_ParameterSet</span></code>.</p>
<p>The value RECOVERY is used in checkpoint/recovery situations, and indicates that the parameter may be altered until the value is read in from a recovery par file, but not after.</p>
</div>
</div>
<div class="section" id="the-schedule-ccl-file">
<h3>The schedule.ccl File<a class="headerlink" href="#the-schedule-ccl-file" title="Permalink to this headline">¶</a></h3>
<p>A schedule configuration file consists of:</p>
<ul class="simple">
<li><p>Assignment statements to switch on storage for grid variables for the entire duration of program execution.</p></li>
<li><p>Schedule blocks to schedule a subroutine from a thorn to be called at specific times during program execution in a given manner.</p></li>
<li><p>Conditional statements for both assignment statements and schedule blocks to allow them to be processed depending on parameter values.</p></li>
</ul>
<div class="section" id="assignment-statements">
<h4>Assignment Statements<a class="headerlink" href="#assignment-statements" title="Permalink to this headline">¶</a></h4>
<p>Assignment statements, currently only assign storage.</p>
<p>These lines have the form:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">STORAGE</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">[</span><span class="n">timelevels</span><span class="p">]</span>
</pre></div>
</div>
<p>If the thorn is active, storage will be allocated, for the given groups, for the duration of program execution (unless storage is explicitly switched off by some call to <code class="docutils literal notranslate"><span class="pre">CCTK_DisableGroupStorage</span></code> within a thorn).</p>
<p>The storage line includes the number of timelevels to activate storage for, this number can be from 1 up to the maximum number or timelevels for the group, as specified in the defining <em>interface.ccl</em> file. Alternatively timelevels can be the name of a parameter accessible to the thorn. The parameter name is the same as used in C routines of the thorn, fully qualified parameter names of the form <code class="docutils literal notranslate"><span class="pre">thorn::parameter</span></code> are not allowed.</p>
<p>The behaviour of an assignment statement is independent of its position in the schedule file (so long as it is outside a schedule block).</p>
</div>
<div class="section" id="schedule-blocks">
<h4>Schedule Blocks<a class="headerlink" href="#schedule-blocks" title="Permalink to this headline">¶</a></h4>
<p>The flesh knows about everything in <em>schedule.ccl</em> files, and handles sorting scheduled routines into an order. Each schedule block in the file schedule.ccl must have the syntax</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">schedule</span> <span class="p">[</span><span class="n">GROUP</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">function</span><span class="o">|</span><span class="n">schedule</span> <span class="n">group</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">AT</span><span class="o">|</span><span class="n">IN</span> <span class="o">&lt;</span><span class="n">schedule</span> <span class="n">bin</span><span class="o">|</span><span class="n">group</span> <span class="n">name</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">AS</span> <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">WHILE</span> <span class="o">&lt;</span><span class="n">variable</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">IF</span> <span class="o">&lt;</span><span class="n">variable</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="n">BEFORE</span><span class="o">|</span><span class="n">AFTER</span> <span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;|</span><span class="p">(</span><span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span> <span class="p">...)]</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nl">LANG</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">FORTRAN</span><span class="o">|</span><span class="n">C</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="nl">STORAGE</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">[</span><span class="n">timelevels</span><span class="p">]]</span>
    <span class="p">[</span><span class="nl">TRIGGERS</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="nl">SYNC</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="nl">OPTIONS</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="nl">TAGS</span><span class="p">:</span> <span class="p">[</span><span class="n">list</span> <span class="n">of</span> <span class="n">keyword</span><span class="o">=</span><span class="n">value</span> <span class="n">definitions</span><span class="p">]]</span>
    <span class="p">[</span><span class="nl">READS</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="nl">WRITES</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">}</span> <span class="s">&quot;A description&quot;</span>
</pre></div>
</div>
<div class="section" id="schedule-bins">
<h5>Schedule Bins<a class="headerlink" href="#schedule-bins" title="Permalink to this headline">¶</a></h5>
<p>Each schedule item is scheduled either AT a particular scheduling bin, or IN a schedule group. A list of the most useful schedule bins for application thorns is given here.</p>
<div class="figure align-default">
<img alt="../../_images/Schedule_Bin.png" src="../../_images/Schedule_Bin.png" />
</div>
<p>In the absence of any ordering, functions in a particular schedule bin will be called in an undetermined order.</p>
</div>
<div class="section" id="group">
<h5>Group<a class="headerlink" href="#group" title="Permalink to this headline">¶</a></h5>
<p>If the optional GROUP specifier is used, the item is a schedule group rather than a normal function. Schedule groups are effectively new, user-defined, schedule bins. Functions or groups may be scheduled IN these, in the same way as they are scheduled AT the main schedule bins.</p>
</div>
<div class="section" id="schedule-options">
<h5>Schedule Options<a class="headerlink" href="#schedule-options" title="Permalink to this headline">¶</a></h5>
<p>The options define various characteristics of the schedule item.</p>
<ul>
<li><p><strong>AS</strong>: This assigns a new name to a function for scheduling purposes.</p></li>
<li><p><strong>WHILE</strong>: This specifies a CCTK_INT grid scalar which is used to control the execution of this item. As long as the grid scalar has a nonzero value, the schedule item will be executed repeatedly.</p></li>
<li><p><strong>IF</strong>: This specifies a CCTK_INT grid scalar which is used to control the execution of this item. If the grid scalar has a nonzero value, the schedule item will be executed, otherwise the item will be ignored. If both an IF and a WHILE clause are present, then the schedule is executed according to the following pseudocode:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">IF</span> <span class="n">condition</span>
    <span class="n">WHILE</span> <span class="n">condition</span>
        <span class="n">SCHEDULE</span> <span class="n">item</span>
    <span class="n">END</span> <span class="n">WHILE</span>
<span class="n">END</span> <span class="n">IF</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><strong>BEFORE</strong> or <strong>AFTER</strong>: These specify either a function or group before or after which this item will be scheduled.</p></li>
</ul>
</div>
<div class="section" id="further-details">
<h5>Further details<a class="headerlink" href="#further-details" title="Permalink to this headline">¶</a></h5>
<p>The schedule block specifies further details of the scheduled function or group.</p>
<ul class="simple">
<li><p><strong>LANG</strong>: This specifies the language of the routine. Currently this is either C or Fortran.</p></li>
<li><p><strong>STORAGE</strong>: The STORAGE keyword specifies groups for which memory should be allocated for the duration of the routine or schedule group. The storage status reverts to its previous status after completion of the routine or schedule group.</p></li>
<li><p><strong>TRIGGER</strong>: List of grid variables or groups to be used as triggers for causing an ANALYSIS function or group to be executed.</p></li>
<li><p><strong>SYNC</strong>: The keyword SYNC specifies groups of variables which should be synchronised (that is, their ghostzones should be exchanged between processors) on exit from the routine.</p></li>
<li><p><strong>OPTIONS</strong>: Often used schedule options are local (also the default), level, or global. These options are interpreted by the driver, not by Cactus.</p></li>
<li><p><strong>TAGS</strong>: Schedule tags. These tags must have the form keyword=value, and must be in a syntax accepted by <code class="docutils literal notranslate"><span class="pre">Util_TableCreateFromString</span></code>.</p></li>
<li><p><strong>READS</strong>: READS is used to declare which grid variables are read by the routine.</p></li>
<li><p><strong>WRITES</strong>: WRITES is used to declare which grid variables are written by the routine.</p></li>
</ul>
</div>
</div>
<div class="section" id="modes">
<h4>Modes<a class="headerlink" href="#modes" title="Permalink to this headline">¶</a></h4>
<p>When looping over grids, Carpet has a standard order to loop over grid attributes.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp"># meta mode</span>
<span class="n">begin</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">mglevel</span> <span class="p">(</span><span class="n">convergence</span> <span class="n">level</span><span class="p">)</span>

    <span class="cp"># global mode</span>
    <span class="n">begin</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">reflevel</span> <span class="p">(</span><span class="n">refinement</span> <span class="n">level</span><span class="p">)</span>

        <span class="cp"># level mode</span>
        <span class="n">begin</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">map</span>

            <span class="cp"># singlemap mode</span>
            <span class="n">begin</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">component</span>
                <span class="cp"># local mode</span>
            <span class="n">end</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">component</span>

        <span class="n">end</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">map</span>

    <span class="n">end</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">reflevel</span>

<span class="n">end</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">mglevel</span>
</pre></div>
</div>
<p>When you schedule a routine (by writing a schedule block in a schedule.ccl file), you specify what mode it should run in. If you don’t specify a mode, the default is local. Since convergence levels aren’t used at present, for most practical purposes meta mode is identical to global mode. Similarly, unless you’re doing multipatch simulations, singlemap mode is identical to level mode.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 19%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Variables</p></th>
<th class="head"><p>meta</p></th>
<th class="head"><p>global</p></th>
<th class="head"><p>level</p></th>
<th class="head"><p>singlemap</p></th>
<th class="head"><p>local</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mglevel</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>reflevel</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>map</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>component</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>CCTK_ORIGIN_SPACE</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>CCTK_DELTA_SPACE</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>CCTK_DELTA_TIME</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_origin_space</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>cctk_delta_space</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_delta_time</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>grid scalars</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>grid arrays</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>grid functions</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<div class="section" id="local">
<h5>Local<a class="headerlink" href="#local" title="Permalink to this headline">¶</a></h5>
<p>Grid functions are defined only in local mode. Since most physics code needs to manipulate grid functions, it therefore must run in local mode. However, in general code scheduled in local mode will run multiple times (because it’s nested inside loops over mglevel, reflevel, map, and component). Sometimes you don’t want this. For example, you may want to open or close an output file, or initialize some global property of your simulation. Global modes are good for this kind of thing.</p>
</div>
<div class="section" id="level">
<h5>Level<a class="headerlink" href="#level" title="Permalink to this headline">¶</a></h5>
<p>Synchronization and turning storage on/off happen in level mode. Boundary conditions must be selected in level mode. Cactus output must be done in level mode.</p>
<p>Reduction/interpolation of grid arrays and/or grid functions may be done in either level mode (applying only to that refinement level), or in global mode (applying to all refinement levels).</p>
</div>
<div class="section" id="singelmap">
<h5>Singelmap<a class="headerlink" href="#singelmap" title="Permalink to this headline">¶</a></h5>
<p>Singelmap mode is mostly useful only if you’re doing multipatch simulations.</p>
</div>
<div class="section" id="querying-and-changing-modes">
<h5>Querying and Changing Modes<a class="headerlink" href="#querying-and-changing-modes" title="Permalink to this headline">¶</a></h5>
<p>Carpet has various functions to query what mode you’re in, and functions and macros to change modes. These are all defined in <em>Carpet/Carpet/src/modes.hh</em>, and are only usable from C++ code.</p>
<p>To use any of these facilities, put the line <code class="docutils literal notranslate"><span class="pre">uses</span> <span class="pre">include:</span> <span class="pre">carpet.hh</span></code> in your <em>interface.ccl</em>, then <code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">&quot;carpet.hh&quot;</span></code> in your C++ source code (this must come after <code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">&quot;cctk.h&quot;</span></code>).</p>
<p>To query the current mode, just use any of the Boolean predicates <code class="docutils literal notranslate"><span class="pre">is_meta_mode()</span></code>, <code class="docutils literal notranslate"><span class="pre">is_global_mode()</span></code>, … , <code class="docutils literal notranslate"><span class="pre">is_local_mode()</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;cassert&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;carpet.hh&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">my_function</span><span class="p">(...)</span>
<span class="p">{</span>
    <span class="c1">// make sure we’re in level mode</span>
    <span class="n">assert</span><span class="p">(</span><span class="n">Carpet</span><span class="o">::</span><span class="n">is_level_mode</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conditional-statements">
<h4>Conditional Statements<a class="headerlink" href="#conditional-statements" title="Permalink to this headline">¶</a></h4>
<p>Besides schedule blocks, it’s possible to embed C style if/else statements in the schedule.ccl file. These can be used to schedule things based upon the value of a parameter.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">conditional</span><span class="o">-</span><span class="n">expression</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">[</span><span class="o">&lt;</span><span class="n">assignments</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="o">&lt;</span><span class="n">schedule</span> <span class="n">blocks</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>&lt;conditional-expression&gt; can be any valid C construct evaluating to a truth value. Such conditionals are evaluated only at program startup, and are used to pick between different static schedule options.</p>
</div>
</div>
<div class="section" id="the-source-file">
<h3>The Source File<a class="headerlink" href="#the-source-file" title="Permalink to this headline">¶</a></h3>
<div class="section" id="compile">
<h4>Compile<a class="headerlink" href="#compile" title="Permalink to this headline">¶</a></h4>
<p>By default, the CCTK looks in the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory of the thorn for source files.</p>
<p>The Cactus make system looks for a file called <code class="docutils literal notranslate"><span class="pre">make.code.defn</span></code> in that directory (if there is no file called <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> in the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory). At its simplest, this file contains two lines</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">SRCS</span> <span class="o">=</span> &lt;list of all <span class="nb">source</span> files in this directory&gt;
<span class="nv">SUBDIRS</span> <span class="o">=</span> &lt;list of all subdirectories, including subdirectories of subdirectories&gt;
</pre></div>
</div>
<p>Each subdirectory listed should then have a <code class="docutils literal notranslate"><span class="pre">make.code.defn</span></code> file containing just a <code class="docutils literal notranslate"><span class="pre">SRCS</span> <span class="pre">=</span></code> line, a <code class="docutils literal notranslate"><span class="pre">SUBDIRS</span> <span class="pre">=</span></code> line will be ignored.</p>
<p>Then you need to build the code. The command you need to run is the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make &lt;name&gt;
</pre></div>
</div>
<p>Each configuration has a <em>ThornList</em> which lists the thorns to be compiled in. When this list changes, only those thorns directly affected by the change are recompiled.</p>
</div>
<div class="section" id="routines">
<h4>Routines<a class="headerlink" href="#routines" title="Permalink to this headline">¶</a></h4>
<p>Any source file using Cactus infrastructure should include the header file <code class="docutils literal notranslate"><span class="pre">cctk.h</span></code> using the line</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<p>Any routine using Cactus argument lists (for example, all routines called from the scheduler at time bins between CCTK_STARTUP and CCTK_SHUTDOWN) should include at the top of the file the header</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<p>A Cactus macro CCTK_ARGUMENTS is defined for each thorn to contain:</p>
<ul class="simple">
<li><p>General information about the grid hierarchy.</p></li>
<li><p>All the grid variables defined in the thorn’s <em>interface.ccl</em>.</p></li>
<li><p>All the grid variables required from other thorns as requested by the <code class="docutils literal notranslate"><span class="pre">inherits</span></code> and <code class="docutils literal notranslate"><span class="pre">friend</span></code> lines in the <em>interface.ccl</em>.</p></li>
</ul>
<p>These variables must be declared at the start of the routine using the macro DECLARE_CCTK_ARGUMENTS.</p>
<p>Any routine using Cactus parameters should include at the top of the file the header</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk_Parameters.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<p>All parameters defined in a thorn’s <em>param.ccl</em>. Booleans and Integers appear as CCTK_INT types (with nonzero/zero values for boolean yes/no), Reals as CCTK_REAL, and Keywords and String parameters as CCTK_STRING. These variables are read only, and changes should not be made to them. The effect of changing a parameter is undefined (at best). To compare a string valued parameter use the function <code class="docutils literal notranslate"><span class="pre">CCTK_Equals()</span></code>.</p>
<p>The parameters should be declared at the start of the routine using them with the macro DECLARE_CCTK_PARAMETERS.</p>
<div class="section" id="example">
<h5>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h5>
<p>The C routine MyCRoutine is scheduled in the schedule.ccl file, and uses Cactus parameters. The source file should look like</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Parameters.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyFunction</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span>
    <span class="n">DECLARE_CCTK_PARAMETERS</span>

    <span class="cm">/* Here goes your code */</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The C++ routine MyCRoutine is scheduled in the schedule.ccl file, and uses Cactus parameters. The source file should look like</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Parameters.h&quot;</span><span class="cp"></span>

<span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="kt">void</span> <span class="n">MyFunction</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span>
    <span class="n">DECLARE_CCTK_PARAMETERS</span>

    <span class="cm">/* Here goes your code */</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The Fortran routine MyCRoutine is scheduled in the schedule.ccl file, and uses Cactus parameters. The source file should look like</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Parameters.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Functions.h&quot;</span><span class="cp"></span>

<span class="n">subroutine</span> <span class="n">MyFunction</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>

    <span class="n">implicit</span> <span class="n">none</span>

    <span class="n">DECLARE_CCTK_ARGUMENTS</span>
    <span class="n">DECLARE_CCTK_PARAMETERS</span>
    <span class="n">DECLARE_CCTK_FUNCTIONS</span>

    <span class="cm">/* Here goes your code */</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="specifically-for-c-programmers">
<h5>Specifically for C Programmers<a class="headerlink" href="#specifically-for-c-programmers" title="Permalink to this headline">¶</a></h5>
<p>Grid functions are held in memory as 1-dimensional C arrays. Cactus provides macros to find the 1-dimensional index which is needed from the multidimensional indices which are usually used. There is a macro for each dimension of grid function. Below is an artificial example to demonstrate this using the 3D macro <code class="docutils literal notranslate"><span class="pre">CCTK_GFINDEX3D</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="k">const</span> <span class="n">ind3d</span> <span class="o">=</span> <span class="n">CCTK_GFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>
            <span class="n">rho</span><span class="p">[</span><span class="n">ind3d</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">pow</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">ind3d</span><span class="p">],</span><span class="mi">2</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">CCTK_GFINDEX3D(cctkGH,i,j,k)</span></code> expands to <code class="docutils literal notranslate"><span class="pre">((i)</span> <span class="pre">+</span> <span class="pre">cctkGH-&gt;cctk_lsh[0]*((j)+cctkGH-&gt;cctk_lsh[1]*(k)))</span></code>. In Fortran, grid functions are accessed as Fortran arrays, i.e. simply as <code class="docutils literal notranslate"><span class="pre">rho(i,j,k)</span></code>.</p>
<p>To access vector grid functions, one also needs to specify the vector index. This is best done via the 3D macro <code class="docutils literal notranslate"><span class="pre">CCTK_VECTGFINDEX3D</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/* vector indices are 0, 1, 2 */</span>
            <span class="n">vel</span><span class="p">[</span><span class="n">CCTK_VECTGFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
            <span class="n">vel</span><span class="p">[</span><span class="n">CCTK_VECTGFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
            <span class="n">vel</span><span class="p">[</span><span class="n">CCTK_VECTGFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cactus-variables">
<h5>Cactus Variables<a class="headerlink" href="#cactus-variables" title="Permalink to this headline">¶</a></h5>
<p>The Cactus variables which are passed through the macro <code class="docutils literal notranslate"><span class="pre">CCTK_ARGUMENTS</span></code> are</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Variables</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cctkGH</p></td>
<td><p>A C pointer identifying the grid hierarchy.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_dim</p></td>
<td><p>An integer with the number of dimensions used for this grid hierarchy.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_lsh</p></td>
<td><p>An array of cctk_dim integers with the local grid size on this processor.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_ash</p></td>
<td><p>An array of cctk_dim integers with the allocated size of the array.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_gsh</p></td>
<td><p>An array of cctk_dim integers with the global grid size.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_iteration</p></td>
<td><p>The current iteration number.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_delta_time</p></td>
<td><p>A CCTK_REAL with the timestep.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_time</p></td>
<td><p>A CCTK_REAL with the current time.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_delta_space</p></td>
<td><p>An array of cctk_dim CCTK_REALs with the grid spacing in each direction.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_nghostzones</p></td>
<td><p>An array of cctk_dim integers with the number of ghostzones used in each direction.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_origin_space</p></td>
<td><p>An array of cctk_dim CCTK_REALs with the spatial coordinates of the global origin of the grid.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_lbnd</p></td>
<td><p>An array of cctk_dim integers containing the lowest index (in each direction) of the local grid, as seen on the global grid.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_ubnd</p></td>
<td><p>An array of cctk_dim integers containing the largest index (in each direction) of the local grid, as seen on the global grid.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_bbox</p></td>
<td><p>An array of 2*cctk_dim integers, which indicate whether the boundaries are internal boundaries (e.g. between processors), or physical boundaries. A value of 1 indicates a physical (outer) boundary at the edge of the computational grid, and 0 indicates an internal boundary.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_levfac</p></td>
<td><p>An array of cctk_dim integer factors by which the local grid is refined in the corresponding direction with respect to the base grid.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_levoff</p></td>
<td><p>Two arrays of cctk_dim integers describing the distance by which the local grid is offset with respect to the base grid, measured in local grid spacings.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_timefac</p></td>
<td><p>The integer factor by which the time step size is reduced with respect to the base grid.</p></td>
</tr>
<tr class="row-odd"><td><p>cctk_convlevel</p></td>
<td><p>The convergence level of this grid hierarchy. The base level is 0, and every level above that is coarsened by a factor of cctk_convfac.</p></td>
</tr>
<tr class="row-even"><td><p>cctk_convfac</p></td>
<td><p>The factor between convergence levels. The relation between the resolutions of different convergence levels is <span class="math notranslate nohighlight">\(\Delta x_{L}=\Delta x_{0} \cdot F^{L}\)</span>, where L is the convergence level and F is the convergence factor. The convergence factor defaults to 2.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="cctk-routines">
<h4>CCTK Routines<a class="headerlink" href="#cctk-routines" title="Permalink to this headline">¶</a></h4>
<div class="section" id="providing-runtime-information">
<h5>Providing Runtime Information<a class="headerlink" href="#providing-runtime-information" title="Permalink to this headline">¶</a></h5>
<p>To write from thorns to standard output (i.e. the screen) at runtime, use the macro <code class="docutils literal notranslate"><span class="pre">CCTK_INFO</span></code>. For example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_INFO</span><span class="p">(</span><span class="s">&quot;Hellow World&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will write the line:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span> <span class="p">(</span><span class="n">MyThorn</span><span class="p">)</span><span class="o">:</span> <span class="n">Hellow</span> <span class="n">World</span>
</pre></div>
</div>
<p>Including variables in the info message use <code class="docutils literal notranslate"><span class="pre">CCTK_VINFO</span></code>. For example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_VINFO</span><span class="p">(</span><span class="s">&quot;The integer is %d&quot;</span><span class="p">,</span> <span class="n">myint</span><span class="p">);</span>
</pre></div>
</div>
<p>Here are some commonly used conversion specifiers:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>specifiers</p></th>
<th class="head"><p>type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>%d</p></td>
<td><p>int</p></td>
</tr>
<tr class="row-odd"><td><p>%g</p></td>
<td><p>real (the shortest representation)</p></td>
</tr>
<tr class="row-even"><td><p>%s</p></td>
<td><p>string</p></td>
</tr>
</tbody>
</table>
<p>For a multiprocessor run, only runtime information from processor zero will be printed to screen by default.</p>
</div>
<div class="section" id="error-handling-warnings-and-code-termination">
<h5>Error Handling, Warnings and Code Termination<a class="headerlink" href="#error-handling-warnings-and-code-termination" title="Permalink to this headline">¶</a></h5>
<p>The Cactus macros <code class="docutils literal notranslate"><span class="pre">CCTK_ERROR</span></code> and <code class="docutils literal notranslate"><span class="pre">CCTK_VERROR</span></code> should be used to output error messages and abort the code. The Cactus macros <code class="docutils literal notranslate"><span class="pre">CCTK_WARN</span></code> and <code class="docutils literal notranslate"><span class="pre">CCTK_VWARN</span></code> should be used to issue warning messages during code execution.</p>
<p>Along with the warning message, an integer is given to indicate the severity of the warning.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 4%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Macros</p></th>
<th class="head"><p>Level</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CCTK_WARN_ABORT</p></td>
<td><p>0</p></td>
<td><p>abort the Cactus run</p></td>
</tr>
<tr class="row-odd"><td><p>CCTK_WARN_ALERT</p></td>
<td><p>1</p></td>
<td><p>the results of this run will be wrong,</p></td>
</tr>
<tr class="row-even"><td><p>CCTK_WARN_COMPLAIN</p></td>
<td><p>2</p></td>
<td><p>the user should know about this, but the problem is not terribly surprising</p></td>
</tr>
<tr class="row-odd"><td><p>CCTK_WARN_PICKY</p></td>
<td><p>3</p></td>
<td><p>this is for small problems that can probably be ignored, but that careful people may want to know about</p></td>
</tr>
<tr class="row-even"><td><p>CCTK_WARN_DEBUG</p></td>
<td><p>4</p></td>
<td><p>these messages are probably useful only for debugging purposes</p></td>
</tr>
</tbody>
</table>
<p>A level 0 warning indicates the highest severity (and is guaranteed to abort the Cactus run), while larger numbers indicate less severe warnings. For example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_WARN</span><span class="p">(</span><span class="n">CCTK_WARN_ALERT</span><span class="p">,</span> <span class="s">&quot;Your warning message&quot;</span><span class="p">);</span>
<span class="n">CCTK_ERROR</span><span class="p">(</span><span class="s">&quot;Your error message&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that if the flesh parameter <code class="docutils literal notranslate"><span class="pre">cctk_full_warnings</span></code> is set to true, then <code class="docutils literal notranslate"><span class="pre">CCTK_ERROR</span></code> and <code class="docutils literal notranslate"><span class="pre">CCTK_WARN</span></code> automatically include the thorn name, the source code file name and line number in the message. The default is to omit the source file name and line number.</p>
<p>Including variables in the warning message use <code class="docutils literal notranslate"><span class="pre">CCTK_VERROR</span></code> and <code class="docutils literal notranslate"><span class="pre">CCTK_VWARN</span></code>. For example,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_VWARN</span><span class="p">(</span><span class="n">CCTK_WARN_ALERT</span><span class="p">,</span> <span class="s">&quot;Your warning message, including %f and %d&quot;</span><span class="p">,</span> <span class="n">myreal</span><span class="p">,</span> <span class="n">myint</span><span class="p">);</span>
<span class="n">CCTK_ERROR</span><span class="p">(</span><span class="s">&quot;Your warning message, including %f and %d&quot;</span><span class="p">,</span> <span class="n">myreal</span><span class="p">,</span> <span class="n">myint</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="iterating-over-grid-points">
<h5>Iterating Over Grid Points<a class="headerlink" href="#iterating-over-grid-points" title="Permalink to this headline">¶</a></h5>
<p>A grid function consists of a multi-dimensional array of grid points. These grid points fall into several types:</p>
<ul class="simple">
<li><p><strong>interior</strong>: regular grid point, presumably evolved in time</p></li>
<li><p><strong>ghost</strong>: inter-process boundary, containing copies of values owned by another process</p></li>
<li><p><strong>physical boundary</strong>: outer boundary, presumably defined via a boundary condition</p></li>
<li><p><strong>symmetry boundary</strong>: defined via a symmetry, e.g. a reflection symmetry or periodicity</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Grid points in the edges and corners may combine several types. For example, a point in a corner may be a ghost point in the x direction, a physical boundary point in the y direction, and a symmetry point in the z direction.</p>
</div>
<p>The size of the physical boundary depends on the application. The number of ghost points is defined by the driver; the number of symmetry points is in principle defined by the thorn implementing the respective symmetry condition, but will in general be the same as the number of ghost points to avoid inconsistencies.</p>
<p>The flesh provides a set of macros to iterate over particular types of grid points.</p>
<ul>
<li><p>Loop over all grid points</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_LOOP3_ALL</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cctkGH</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/* body of the loop */</span>
<span class="p">}</span> <span class="n">CCTK_ENDLOOP3_ALL</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Loop over all interior grid points</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_LOOP3_INT</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cctkGH</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/* body of the loop */</span>
<span class="p">}</span> <span class="n">CCTK_ENDLOOP3_INT</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Loop over all physical boundary points</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">LOOP_BND</span></code> loops over all points that are physical boundaries (independent of whether they also are symmetry or ghost boundaries).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_LOOP3_BND</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cctkGH</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span><span class="n">nj</span><span class="p">,</span><span class="n">nk</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/* body of the loop */</span>
<span class="p">}</span> <span class="n">CCTK_ENDLOOP3_BND</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Loop over all “interior” physical boundary point</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">LOOP_INTBND</span></code> loops over those points that are only physical boundaries (and excludes any points that belongs to a symmetry or ghost boundary).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CCTK_LOOP3_INTBND</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cctkGH</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span><span class="n">nj</span><span class="p">,</span><span class="n">nk</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/* body of the loop */</span>
<span class="p">}</span> <span class="n">CCTK_ENDLOOP3_INTBND</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>In all cases, name should be replaced by a unique name for the loop. i, j, and k are names of variables that will be declared and defined by these macros, containing the index of the current grid point. Similarly ni, nj, and nk are names of variables describing the (outwards pointing) normal direction to the boundary as well as the distance to the boundary.</p>
</div>
<div class="section" id="interpolation-operators">
<h5>Interpolation Operators<a class="headerlink" href="#interpolation-operators" title="Permalink to this headline">¶</a></h5>
<p>There are two different flesh APIs for interpolation, depending on whether the data arrays are Cactus grid arrays or processor-local, programming language built-in arrays.</p>
<p><code class="docutils literal notranslate"><span class="pre">CCTK_InterpGridArrays()</span></code> function interpolates a list of CCTK grid variables (in a multiprocessor run these are generally distributed over processors) on a list of interpolation points. The grid topology and coordinates are implicitly specified via a Cactus coordinate system. The interpolation points may be anywhere in the global Cactus grid. Additional parameters for the interpolation operation can be passed in via a handle to a key-value options table.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;util_Table.h&quot;</span><span class="cp"></span>

<span class="cm">/* Pointer to a valid Cactus grid hierarchy. */</span>
<span class="k">const</span> <span class="n">cGH</span> <span class="o">*</span><span class="n">GH</span><span class="p">;</span>

<span class="cm">/* Number of dimensions in which to interpolate. */</span>
<span class="cp">#define N_DIMS 3</span>

<span class="cm">/* Handle to the local interpolation operator as returned by CCTK_InterpHandle. */</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">operator_handle</span> <span class="o">=</span> <span class="n">CCTK_InterpHandle</span><span class="p">(</span><span class="n">interpolator_name</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">operator_handle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CCTK_VWARN</span><span class="p">(</span><span class="n">CCTK_WARN_ABORT</span><span class="p">,</span> <span class="s">&quot;Couldn&#39;t find interpolator </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">!&quot;</span><span class="p">,</span> <span class="n">interpolator_name</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Handle to a key-value table containing zero or more additional parameters for the interpolation operation. */</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">param_table_handle</span> <span class="o">=</span> <span class="n">Util_TableCreateFromString</span><span class="p">(</span><span class="n">interpolator_pars</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">param_table_handle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CCTK_VWARN</span><span class="p">(</span><span class="n">CCTK_WARN_ABORT</span><span class="p">,</span> <span class="s">&quot;Bad interpolator parameter(s) </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">!&quot;</span><span class="p">,</span> <span class="n">interpolator_pars</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Handle to Cactus coordinate system as returned by CCTK_CoordSystemHandle. */</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">coord_system_handle</span> <span class="o">=</span> <span class="n">CCTK_CoordSystemHandle</span><span class="p">(</span><span class="n">coord_name</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">coord_system_handle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CCTK_VWARN</span><span class="p">(</span><span class="n">CCTK_WARN_ABORT</span><span class="p">,</span> <span class="s">&quot;Couldn&#39;t get coordinate-system </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">!&quot;</span><span class="p">,</span> <span class="n">coord_name</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* The number of interpolation points requested by this processor. */</span>
<span class="cp">#define N_INTERP_POINTS 1000</span>

<span class="cm">/* (Pointer to) an array of N dims pointers to 1-D arrays giving the coordinates of the interpolation points requested by this processor. These coordinates are with respect to the coordinate system defined by coord system handle. */</span>
<span class="n">CCTK_REAL</span> <span class="n">interp_x</span><span class="p">[</span><span class="n">N_INTERP_POINTS</span><span class="p">],</span> <span class="n">interp_y</span><span class="p">[</span><span class="n">N_INTERP_POINTS</span><span class="p">],</span> <span class="n">interp_z</span><span class="p">[</span><span class="n">N_INTERP_POINTS</span><span class="p">];</span>
<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">interp_coords</span><span class="p">[</span><span class="n">N_DIMS</span><span class="p">];</span>

<span class="n">interp_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">interp_x</span><span class="p">;</span>
<span class="n">interp_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">interp_y</span><span class="p">;</span>
<span class="n">interp_coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">interp_z</span><span class="p">;</span>

<span class="cm">/* The number of input variables to be interpolated. */</span>
<span class="cp">#define N_INPUT_ARRAYS 2</span>

<span class="cm">/* (Pointer to) an array of N_input_arrays CCTK grid variable indices (as returned by CCTK_VarIndex) specifying the input grid variables for the interpolation. */</span>
<span class="n">CCTK_INT</span> <span class="n">input_array_variable_indices</span><span class="p">[</span><span class="n">N_INPUT_ARRAYS</span><span class="p">];</span>
<span class="n">input_array_variable_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s">&quot;my_thorn::var1&quot;</span><span class="p">);</span>
<span class="n">input_array_variable_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s">&quot;my_thorn::var2&quot;</span><span class="p">);</span>

<span class="cm">/* The number of output arrays to be returned from the interpolation. Note that N_output_arrays may differ from N_input_arrays. */</span>
<span class="cp">#define N_OUTPUT_ARRAYS 2</span>

<span class="cm">/* Giving the data types of the 1-D output arrays pointed to by output_arrays[]. */</span>
<span class="n">CTK_INT</span> <span class="n">output_array_type_codes</span><span class="p">[</span><span class="n">N_OUTPUT_ARRAYS</span><span class="p">]</span>
<span class="n">output_array_type_codes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCTK_VARIABLE_REAL</span>
<span class="n">output_array_type_codes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCTK_VARIABLE_COMPLEX</span>

<span class="cm">/* (Pointer to) an array of N_output_arrays pointers to the (user-supplied) 1-D output arrays for the interpolation. */</span>
<span class="kt">void</span> <span class="o">*</span><span class="n">output_arrays</span><span class="p">[</span><span class="n">N_OUTPUT_ARRAYS</span><span class="p">];</span>
<span class="n">CCTK_REAL</span> <span class="n">output_for_real_array</span> <span class="p">[</span><span class="n">N_INTERP_POINTS</span><span class="p">];</span>
<span class="n">CCTK_COMPLEX</span> <span class="n">output_for_complex_array</span><span class="p">[</span><span class="n">N_INTERP_POINTS</span><span class="p">];</span>
<span class="n">output_arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">output_for_real_array</span><span class="p">;</span>
<span class="n">output_arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">output_for_complex_array</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="n">CCTK_InterpGridArrays</span><span class="p">(</span>
    <span class="n">GH</span><span class="p">,</span>
    <span class="n">N_DIMS</span><span class="p">,</span>
    <span class="n">operator_handle</span><span class="p">,</span>
    <span class="n">param_table_handle</span><span class="p">,</span>
    <span class="n">coord_system_handle</span><span class="p">,</span>
    <span class="n">N_INTERP_POINTS</span><span class="p">,</span>
    <span class="n">CCTK_VARIABLE_REAL</span><span class="p">,</span> <span class="c1">// Giving the data type of the interpolation-point coordinate arrays pointed to by interp_coords[].</span>
    <span class="n">interp_coords</span><span class="p">,</span>
    <span class="n">N_INPUT_ARRAYS</span><span class="p">,</span>
    <span class="n">input_array_variable_indices</span><span class="p">,</span>
    <span class="n">N_OUTPUT_ARRAYS</span><span class="p">,</span>
    <span class="n">output_array_type_codes</span><span class="p">,</span>
    <span class="n">output_arrays</span>
<span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CCTK_WARN</span><span class="p">(</span><span class="n">CCTK_WARN_ABORT</span><span class="p">,</span> <span class="s">&quot;error return from interpolator!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CCTK_InterpLocalUniform()</span></code> interpolate a list of processor-local arrays which define a uniformly-spaced data grid.</p>
</div>
<div class="section" id="reduction-operators">
<h5>Reduction Operators<a class="headerlink" href="#reduction-operators" title="Permalink to this headline">¶</a></h5>
<p>A reduction operation can be defined as an operation on variables distributed across multiple processor resulting in a single number. Typical reduction operations are: sum, minimum/maximum value, and boolean operations. The different operators are identified by their name and/or a unique number, called a handle.</p>
<p>There are two different flesh APIs for reduction, depending on whether the data arrays are Cactus grid arrays or processor-local, programming language built-in arrays.</p>
<p><code class="docutils literal notranslate"><span class="pre">CCTK_ReduceGridArrays()</span></code> reduces a list of CCTK grid arrays (in a multiprocessor run these are generally distributed over processors).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;util_Table.h&quot;</span><span class="cp"></span>

<span class="cm">/* Pointer to a valid Cactus grid hierarchy. */</span>
<span class="k">const</span> <span class="n">cGH</span> <span class="o">*</span><span class="n">GH</span><span class="p">;</span>

<span class="cm">/* Handle to the local reduction operator as returned by CCTK_LocalArrayReductionHandle(). */</span>


<span class="k">const</span> <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="n">CCTK_ReduceGridArrays</span><span class="p">(</span>
    <span class="n">GH</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="c1">// The destination processor</span>
    <span class="n">param_table_handle</span><span class="p">,</span>
    <span class="n">N_INPUT_ARRAYS</span><span class="p">,</span>
    <span class="n">input_array_variable_indices</span><span class="p">,</span>
    <span class="n">M_OUTPUT_VALUES</span><span class="p">,</span>
    <span class="n">output_value_type_codes</span><span class="p">,</span>
    <span class="n">output_values</span>
<span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CCTK_ReduceLocalArrays()</span></code> performs reduction on a list of local grid arrays.</p>
</div>
</div>
<div class="section" id="utility-routines">
<h4>Utility Routines<a class="headerlink" href="#utility-routines" title="Permalink to this headline">¶</a></h4>
<p>As well as the high-level <code class="docutils literal notranslate"><span class="pre">CCTK_*</span></code> routines, Cactus also provides a set of lower-level <code class="docutils literal notranslate"><span class="pre">Util_*</span></code> utility routines which thorns developers may use. Cactus functions may need to pass information through a generic interface. In the past, we often had trouble passing <code class="docutils literal notranslate"><span class="pre">extra</span></code> information that wasn’t anticipated in the original design. Key-value tables provide a clean solution to these problems. They’re implemented by the <code class="docutils literal notranslate"><span class="pre">Util_Table*</span></code> functions.</p>
</div>
</div>
</div>
<div class="section" id="paramcheck">
<h2>ParamCheck<a class="headerlink" href="#paramcheck" title="Permalink to this headline">¶</a></h2>
<p>In your <em>schedule.ccl</em> file.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEDULE</span> <span class="n">MyCRoutine_ParamCheck</span> <span class="n">AT</span> <span class="n">CCTK_PARAMCHECK</span>
<span class="p">{</span>
    <span class="nl">LANG</span><span class="p">:</span> <span class="n">C</span>
<span class="p">}</span> <span class="s">&quot;ParamCheck&quot;</span>
</pre></div>
</div>
<p>In your code.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Parameters.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyCRoutine_ParamCheck</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span><span class="p">;</span>
    <span class="n">DECLARE_CCTK_PARAMETERS</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="n">CCTK_EQUALS</span><span class="p">(</span><span class="n">metric_type</span><span class="p">,</span> <span class="s">&quot;physical&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
       <span class="o">!</span> <span class="n">CCTK_EQUALS</span><span class="p">(</span><span class="n">metric_type</span><span class="p">,</span> <span class="s">&quot;static conformal&quot;</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">CCTK_PARAMWARN</span><span class="p">(</span><span class="s">&quot;Unknown ADMBase::metric_type - known types are </span><span class="se">\&quot;</span><span class="s">physical</span><span class="se">\&quot;</span><span class="s"> and </span><span class="se">\&quot;</span><span class="s">static conformal</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="api">
<h3>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.CCTK_IsThornActive">
int <code class="sig-name descname">CCTK_IsThornActive</code><span class="sig-paren">(</span>const char*<em> thorn</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_IsThornActive" title="Permalink to this definition">¶</a></dt>
<dd><p>Reports whether a thorn was activated in a parameter file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thorn</strong> (<em>char</em>) – The character-string name of the thorn</p></li>
</ul>
</dd>
<dt class="field-even">Result</dt>
<dd class="field-even"><p><strong>status</strong> (<em>int</em>) This function returns a non-zero value if thorn was activated in a parameter file, and zero otherwise.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="p">(</span><span class="n">CCTK_IsThornActive</span> <span class="p">(</span><span class="s2">&quot;MoL&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">/*</span> <span class="n">Here</span> <span class="n">goes</span> <span class="n">your</span> <span class="n">code</span> <span class="o">*/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_ParameterValString">
char <code class="sig-name descname">CCTK_ParameterValString</code><span class="sig-paren">(</span>const char<em> *name</em>, const char<em> *thorn</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_ParameterValString" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the string representation of a parameter’s value.</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>The memory must be released with a call to <code class="docutils literal notranslate"><span class="pre">free()</span></code> after it has been used.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<em>char</em>) – Parameter name</p></li>
<li><p><strong>thorn</strong> (<em>char</em>) – Thorn name (for private parameters) or implementation name (for restricted parameters)</p></li>
</ul>
</dd>
<dt class="field-odd">Result</dt>
<dd class="field-odd"><p><strong>valstring</strong> (<em>char</em>) - Pointer to parameter value as string</p>
</dd>
<dt class="field-even">Error</dt>
<dd class="field-even"><p><strong>NULL</strong> - No parameter with that name was found.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">char</span> <span class="o">*</span><span class="n">valstring</span> <span class="o">=</span> <span class="n">CCTK_ParameterValString</span><span class="p">(</span><span class="s2">&quot;cctk_run_title&quot;</span><span class="p">,</span> <span class="s2">&quot;Cactus&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span> <span class="n">valstring</span> <span class="o">!=</span> <span class="n">NULL</span> <span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">free</span><span class="p">(</span><span class="n">valstring</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_ParameterGet">
<code class="sig-name descname">CCTK_ParameterGet</code><span class="sig-paren">(</span>const char<em> *name</em>, const char<em> *thorn</em>, int<em> *type</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_ParameterGet" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data pointer to and type of a parameter’s value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>char</em>) – Parameter name</p></li>
<li><p><strong>thorn</strong> (<em>char</em>) – Thorn name (for private parameters) or implementation name (for restricted parameters)</p></li>
<li><p><strong>type</strong> (<em>int</em>) – If not NULL, a pointer to an integer which will hold the type of the parameter</p></li>
</ul>
</dd>
<dt class="field-even">Result</dt>
<dd class="field-even"><p><strong>valstring</strong> (<em>char</em>) - Pointer to the parameter value</p>
</dd>
<dt class="field-odd">Error</dt>
<dd class="field-odd"><p><strong>NULL</strong> - No parameter with that name was found.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">ghost_ptr</span> <span class="o">=</span> <span class="n">CCTK_ParameterGet</span><span class="p">(</span><span class="s2">&quot;ghost_size&quot;</span><span class="p">,</span> <span class="s2">&quot;Carpet&quot;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span> <span class="n">ghost_ptr</span> <span class="o">!=</span> <span class="n">NULL</span> <span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span> <span class="n">ghost</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="p">)</span><span class="n">ghost_ptr</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="coordinate">
<h2>Coordinate<a class="headerlink" href="#coordinate" title="Permalink to this headline">¶</a></h2>
<div class="section" id="global-coordinates">
<h3>Global coordinates<a class="headerlink" href="#global-coordinates" title="Permalink to this headline">¶</a></h3>
<p>Compute the global Cactus xyz coordinates of the current grid point.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyThorn_MyFunction</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// variables declared with &#39;const&#39; added become constants and cannot be altered by the program.</span>
                <span class="k">const</span> <span class="kt">int</span> <span class="n">ind3d</span> <span class="o">=</span> <span class="n">CCTK_GFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>

                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">xL</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">yL</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">zL</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">rL</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyThorn_MyFunction</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
    <span class="cm">/* Do not compute in ghost zones */</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">ghost</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ghost</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">ghost</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ghost</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">ghost</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">ghost</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">const</span> <span class="kt">int</span> <span class="n">ind3d</span> <span class="o">=</span> <span class="n">CCTK_GFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>

                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">xL</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">yL</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">zL</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="n">rL</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">ind3d</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cartgrid3d">
<h3>CartGrid3D<a class="headerlink" href="#cartgrid3d" title="Permalink to this headline">¶</a></h3>
<p><cite>CartGrid3D</cite> allows you to enforce even or odd parity for any grid function at (across) each coordinate axis. For a function <span class="math notranslate nohighlight">\(\phi(x, y, z)\)</span>, even parity symmetry on the x-axis means</p>
<div class="math notranslate nohighlight">
\[\phi(-x, y, z)=\phi(x, y, z)\]</div>
<p>while odd parity symmetry means</p>
<div class="math notranslate nohighlight">
\[\phi(-x, y, z)=- \phi(x, y, z)\]</div>
<p>You first need to get access to the include ﬁle by putting the line in your <cite>interface.ccl</cite> file.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">uses</span> <span class="nl">include</span><span class="p">:</span> <span class="n">Symmetry</span><span class="p">.</span><span class="n">h</span>
</pre></div>
</div>
<p>Symmetries should obviously be registered before they are used, but since they can be diﬀerent for diﬀerent grids, they must be registered after the <code class="docutils literal notranslate"><span class="pre">CCTK_STARTUP</span></code> timebin. The usual place to register symmetries is in the <code class="docutils literal notranslate"><span class="pre">CCTK_BASEGRID</span></code> timebin.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEDULE</span> <span class="n">MyCRoutine_RegisterSymmetry</span> <span class="n">AT</span> <span class="n">CCTK_BASEGRID</span>
<span class="p">{</span>
    <span class="nl">LANG</span><span class="p">:</span> <span class="n">C</span>
    <span class="nl">OPTIONS</span><span class="p">:</span> <span class="n">global</span>
<span class="p">}</span> <span class="s">&quot;Register symmetry&quot;</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;Symmetry.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyCRoutine_RegisterSymmetry</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">sym</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">ierr</span><span class="p">;</span>

    <span class="n">sym</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">sym</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">sym</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="cm">/* Applies symmetry boundary conditions from variable name */</span>
    <span class="n">ierr</span> <span class="o">=</span> <span class="n">SetCartSymVN</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span> <span class="n">sym</span><span class="p">,</span> <span class="s">&quot;ADMAnalysis::Ricci23&quot;</span><span class="p">);</span>
    <span class="cm">/* error information */</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">CCTK_VWarn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">__FILE__</span><span class="p">,</span> <span class="s">&quot;Thorn_Name&quot;</span><span class="p">,</span> <span class="s">&quot;Error returned from function SetCartSymVN&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="boundary">
<h3>Boundary<a class="headerlink" href="#boundary" title="Permalink to this headline">¶</a></h3>
<p>The implementation <cite>Boundary</cite> provides a number of aliased functions, which allow application thorns to register routines which provide a particular physical boundary condition, and also to select variables or groups of variables to have boundary conditions applied to whenever the <cite>ApplyBCs</cite> schedule group is scheduled.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEDULE</span> <span class="n">MyCRoutine_Boundaries</span>
<span class="p">{</span>
    <span class="nl">LANG</span><span class="p">:</span> <span class="n">C</span>
<span class="p">}</span>  <span class="s">&quot;Select boundary conditions&quot;</span>

<span class="n">SCHEDULE</span> <span class="n">GROUP</span> <span class="n">ApplyBCs</span> <span class="n">as</span> <span class="n">MyCRoutine_Boundaries</span>
<span class="p">{</span>
<span class="p">}</span> <span class="s">&quot;Apply boundary conditions&quot;</span>
</pre></div>
</div>
<p>To select a grid variable to have a boundary condition applied to it, use one of the following aliased functions:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyCRoutine_Boundaries</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">ierr</span><span class="p">;</span>

    <span class="cm">/* Select an entire variable group, using its name. */</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">Boundary_SelectGroupForBC</span><span class="p">(</span>
        <span class="n">cctkGH</span><span class="p">,</span> <span class="c1">// Grid hierarchy pointer</span>
        <span class="n">CCTK_ALL_FACES</span><span class="p">,</span> <span class="c1">// CCTK_ALL_FACES corresponds to the set of all faces of the domain.</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1">// use default values</span>
        <span class="s">&quot;ADMAnalysis::ricci_scalar&quot;</span><span class="p">,</span> <span class="c1">// group name: (&lt;implementation&gt;::&lt;group_name&gt;)</span>
        <span class="s">&quot;Flat&quot;</span> <span class="c1">// The boundary conditions available are Scalar, Flat, Radiation, Copy, Robin, Static, and None.</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">CCTK_WARN</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;Error in applying flat boundary condition&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each of these functions takes a faces speciﬁcation, a boundary width, and a table handle as additional arguments. The faces specification is a single integer which identifies a set of faces to which to apply the boundary condition. The boundary width is the thickness, in grid points, of the boundaries. The table handle identifies a table which holds extra arguments for the particular boundary condition that is requested.</p>
</div>
</div>
<div class="section" id="initial-data">
<h2>Initial Data<a class="headerlink" href="#initial-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="timelevel">
<h3>Timelevel<a class="headerlink" href="#timelevel" title="Permalink to this headline">¶</a></h3>
<p>These are best introduced by an example using finite differencing. Consider the 1-D wave equation</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^{2} \phi}{\partial t^{2}}=\frac{\partial^{2} \phi}{\partial x^{2}}\]</div>
<p>To solve this by partial differences, one discretises the derivatives to get an equation relating the solution at different times. There are many ways to do this, one of which produces the following difference equation</p>
<div class="math notranslate nohighlight">
\[\phi(t+\Delta t, x)-2 \phi(t, x)+\phi(t-\Delta t, x)=\frac{\Delta t^{2}}{\Delta x^{2}}\{\phi(t, x+\Delta x)-2 \phi(t, x)+\phi(t, x-\Delta x)\}\]</div>
<p>which relates the three timelevels <span class="math notranslate nohighlight">\(t+\Delta t\)</span>, <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(t-\Delta t\)</span>.</p>
<p>All timelevels, except the current level, should be considered read-only during evolution, that is, their values should not be changed by thorns. The exception to this rule is for function initialisation, when the values at the previous timelevels do need to be explicitly filled out.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">timelevels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">STORAGE</span><span class="p">:</span> <span class="n">rho</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">timelevels</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">STORAGE</span><span class="p">:</span> <span class="n">rho</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">timelevels</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">STORAGE</span><span class="p">:</span> <span class="n">rho</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>#include &lt;cctk.h&gt;
#include &lt;cctk_Arguments.h&gt;
#include &lt;cctk_Parameters.h&gt;

void MyCRoutine_Zero(CCTK_ARGUMENTS)
{
    const int np = cctk_ash[0] * cctk_ash[1] * cctk_ash[2];

    if (CCTK_ActiveTimeLevels(cctkGH, &quot;HydroBase::rho&quot;) &gt;= 1) {
#pragma omp parallel for
        for (int i = 0; i &lt; np; ++i) {
            rho[i] = 0.0; \* Set rho to 0 *\
        }
    }

    if (CCTK_ActiveTimeLevels(cctkGH, &quot;HydroBase::rho&quot;) &gt;= 2) {
#pragma omp parallel for
        for (int i = 0; i &lt; np; ++i) {
            rho_p[i] = 0.0;
        }
    }

    if (CCTK_ActiveTimeLevels(cctkGH, &quot;HydroBase::rho&quot;) &gt;= 3) {
#pragma omp parallel for
        for (int i = 0; i &lt; np; ++i) {
            rho_p_p[i] = 0.0;
        }
    }
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="numerical">
<h2>Numerical<a class="headerlink" href="#numerical" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="calculation">
<h3>Calculation<a class="headerlink" href="#calculation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>determinant</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stddef.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyThorn_MyFunction</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cctk_lsh</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">CCTK_GFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>

                <span class="kt">double</span> <span class="n">gxxL</span> <span class="o">=</span> <span class="n">gxx</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
                <span class="kt">double</span> <span class="n">gxyL</span> <span class="o">=</span> <span class="n">gxy</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
                <span class="kt">double</span> <span class="n">gxzL</span> <span class="o">=</span> <span class="n">gxz</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
                <span class="kt">double</span> <span class="n">gyyL</span> <span class="o">=</span> <span class="n">gyy</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
                <span class="kt">double</span> <span class="n">gyzL</span> <span class="o">=</span> <span class="n">gyz</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
                <span class="kt">double</span> <span class="n">gzzL</span> <span class="o">=</span> <span class="n">gzz</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

                <span class="kt">double</span> <span class="n">det</span> <span class="o">=</span> <span class="o">-</span><span class="n">gxzL</span><span class="o">*</span><span class="n">gxzL</span><span class="o">*</span><span class="n">gyyL</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">gxyL</span><span class="o">*</span><span class="n">gxzL</span><span class="o">*</span><span class="n">gyzL</span> <span class="o">-</span> <span class="n">gxxL</span><span class="o">*</span><span class="n">gyzL</span><span class="o">*</span><span class="n">gyzL</span> <span class="o">-</span> <span class="n">gxyL</span><span class="o">*</span><span class="n">gxyL</span><span class="o">*</span><span class="n">gzzL</span> <span class="o">+</span> <span class="n">gxxL</span><span class="o">*</span><span class="n">gyyL</span><span class="o">*</span><span class="n">gzzL</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">invdet</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">det</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">gupxxL</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">gyzL</span><span class="o">*</span><span class="n">gyzL</span> <span class="o">+</span> <span class="n">gyyL</span><span class="o">*</span><span class="n">gzzL</span><span class="p">)</span><span class="o">*</span><span class="n">invdet</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">gupxyL</span><span class="o">=</span><span class="p">(</span> <span class="n">gxzL</span><span class="o">*</span><span class="n">gyzL</span> <span class="o">-</span> <span class="n">gxyL</span><span class="o">*</span><span class="n">gzzL</span><span class="p">)</span><span class="o">*</span><span class="n">invdet</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">gupyyL</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">gxzL</span><span class="o">*</span><span class="n">gxzL</span> <span class="o">+</span> <span class="n">gxxL</span><span class="o">*</span><span class="n">gzzL</span><span class="p">)</span><span class="o">*</span><span class="n">invdet</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">gupxzL</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">gxzL</span><span class="o">*</span><span class="n">gyyL</span> <span class="o">+</span> <span class="n">gxyL</span><span class="o">*</span><span class="n">gyzL</span><span class="p">)</span><span class="o">*</span><span class="n">invdet</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">gupyzL</span><span class="o">=</span><span class="p">(</span> <span class="n">gxyL</span><span class="o">*</span><span class="n">gxzL</span> <span class="o">-</span> <span class="n">gxxL</span><span class="o">*</span><span class="n">gyzL</span><span class="p">)</span><span class="o">*</span><span class="n">invdet</span><span class="p">;</span>
                <span class="kt">double</span> <span class="n">gupzzL</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">gxyL</span><span class="o">*</span><span class="n">gxyL</span> <span class="o">+</span> <span class="n">gxxL</span><span class="o">*</span><span class="n">gyyL</span><span class="p">)</span><span class="o">*</span><span class="n">invdet</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="volume-integral">
<h3>Volume integral<a class="headerlink" href="#volume-integral" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyCRoutine</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span><span class="p">;</span>

    <span class="n">CCTK_INT</span> <span class="n">reduction_handle</span><span class="p">;</span>

    <span class="n">reduction_handle</span> <span class="o">=</span> <span class="n">CCTK_ReductionHandle</span><span class="p">(</span><span class="s">&quot;sum&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reduction_handle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">CCTK_WARN</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Unable to get reduction handle.&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">CCTK_Reduce</span><span class="p">(</span>
        <span class="n">cctkGH</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">reduction_handle</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="n">CCTK_VARIABLE_REAL</span><span class="p">,</span>
        <span class="o">&amp;</span><span class="n">ADMMass_VolumeMass</span><span class="p">[</span><span class="o">*</span><span class="n">ADMMass_LoopCounter</span><span class="p">],</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s">&quot;ADMMass::ADMMass_VolumeMass_GF&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1">// TODO ADMMass</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="surface-integral">
<h3>Surface integral<a class="headerlink" href="#surface-integral" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cctk.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cctk_Arguments.h&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">MyCRoutine</span><span class="p">(</span><span class="n">CCTK_ARGUMENTS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">DECLARE_CCTK_ARGUMENTS</span><span class="p">;</span>

    <span class="c1">// TODO ADMMass</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="i-o">
<h2>I/O<a class="headerlink" href="#i-o" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>API<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.CCTK_VarIndex">
int <code class="sig-name descname">CCTK_VarIndex</code><span class="sig-paren">(</span>const char<em> *varname</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_VarIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the index for a variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>The variable name should be the given in its fully qualified form, that is <code class="docutils literal notranslate"><span class="pre">&lt;implementation&gt;::&lt;variable&gt;</span></code> for PUBLIC or PROTECTED variables and <code class="docutils literal notranslate"><span class="pre">&lt;thorn&gt;::&lt;variable&gt;</span></code> for PRIVATE variables.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>varname</strong> (<em>char</em>) – The name of the variable.</p></li>
</ul>
</dd>
<dt class="field-odd">Error</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>-1</strong> - no variable of this name exists</p></li>
<li><p><strong>-2</strong> - no failed to catch error code from <code class="docutils literal notranslate"><span class="pre">Util_SplitString</span></code></p></li>
<li><p><strong>-3</strong> - given full name is in wrong format</p></li>
<li><p><strong>-4</strong> - memory allocation failed</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s2">&quot;evolve::phi&quot;</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s2">&quot;evolve::vect[0]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_GroupIndexFromVarI">
int <code class="sig-name descname">CCTK_GroupIndexFromVarI</code><span class="sig-paren">(</span>int<em> varindex</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_GroupIndexFromVarI" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable index, returns the index of the associated group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>varindex</strong> (<em>int</em>) – The index of the variable</p></li>
</ul>
</dd>
<dt class="field-even">Result</dt>
<dd class="field-even"><p><strong>groupindex</strong> (<em>int</em>) - The index of the group</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s2">&quot;evolve::phi&quot;</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupindex</span> <span class="o">=</span> <span class="n">CCTK_GroupIndexFromVarI</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_FullName">
char <code class="sig-name descname">CCTK_FullName</code><span class="sig-paren">(</span>int<em> index</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_FullName" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable index, returns the full name of the variable</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>The full variable name is in the form <code class="docutils literal notranslate"><span class="pre">&lt;implementation&gt;::&lt;variable&gt;</span></code> for PUBLIC or PROTECTED variables and <code class="docutils literal notranslate"><span class="pre">&lt;thorn&gt;::&lt;variable&gt;</span></code> for PRIVATE variables.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>) – The variable index</p></li>
</ul>
</dd>
<dt class="field-odd">Result</dt>
<dd class="field-odd"><p><strong>implementation</strong> (<em>char</em>) - The full variable name</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="n">CCTK_FullName</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_VarTypeI">
int <code class="sig-name descname">CCTK_VarTypeI</code><span class="sig-paren">(</span>int<em> index</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_VarTypeI" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides variable type index from the variable index</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>The variable type index indicates the type of the variable. Either character, int, complex or real. The group type can be checked with the Cactus provided macros for CCTK_VARIABLE_INT, CCTK_VARIABLE_REAL, CCTK_VARIABLE_COMPLEX or CCTK_VARIABLE_CHAR.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>) – The variable index</p></li>
</ul>
</dd>
<dt class="field-odd">Result</dt>
<dd class="field-odd"><p><strong>type</strong> (<em>int</em>) - The variable type index</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vtype</span> <span class="o">=</span> <span class="n">CCTK_VarTypeI</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="p">(</span><span class="n">vtype</span> <span class="o">==</span> <span class="n">CCTK_VARIABLE_REAL</span><span class="p">)</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">/*</span> <span class="n">Here</span> <span class="n">goes</span> <span class="n">your</span> <span class="n">code</span> <span class="o">*/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_GroupTypeI">
int <code class="sig-name descname">CCTK_GroupTypeI</code><span class="sig-paren">(</span>int<em> group</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_GroupTypeI" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a group type index given a group index</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>A group type index indicates the type of variables in the group. The group type can be checked with the Cactus provided macros for CCTK_SCALAR, CCTK_GF, CCTK_ARRAY.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>group</strong> (<em>int</em>) – Group index.</p></li>
</ul>
</dd>
<dt class="field-odd">Error</dt>
<dd class="field-odd"><p><strong>-1</strong> - the given group index is invalid.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gtype</span> <span class="o">=</span> <span class="n">CCTK_GroupTypeI</span><span class="p">(</span><span class="n">gindex</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="p">(</span><span class="n">gtype</span> <span class="o">==</span> <span class="n">CCTK_GF</span><span class="p">)</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">/*</span> <span class="n">Here</span> <span class="n">goes</span> <span class="n">your</span> <span class="n">code</span> <span class="o">*/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_VarDataPtrI">
void <code class="sig-name descname">CCTK_VarDataPtrI</code><span class="sig-paren">(</span>const <a class="reference internal" href="../API/main.html#c.cGH" title="cGH">cGH</a> *<em> cctkGH</em>, int<em> timelevel</em>, int<em> index</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_VarDataPtrI" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data pointer for a grid variable from the variable index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cctkGH</strong> – pointer to CCTK grid hierarchy</p></li>
<li><p><strong>timelevel</strong> (<em>int</em>) – The timelevel of the grid variable</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the variable</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CCTK_REAL</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vindex</span> <span class="o">=</span> <span class="n">CCTK_VarIndex</span><span class="p">(</span><span class="s2">&quot;evolve::phi&quot;</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">CCTK_REAL</span><span class="o">*</span><span class="p">)</span> <span class="n">CCTK_VarDataPtrI</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vindex</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_GroupData">
<code class="sig-name descname">CCTK_GroupData</code><span class="sig-paren">(</span>int<em> group_index</em>, cGroup*<em> group_data_buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_GroupData" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a group index, returns information about the group and its variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>The cGroup structure contains (at least) the following members:</p>
<ul class="simple">
<li><p><strong>grouptype</strong> (<em>int</em>) - group type</p></li>
<li><p><strong>vartype</strong> (<em>int</em>) - variable type</p></li>
<li><p><strong>disttype</strong> (<em>int</em>) - distribution type</p></li>
<li><p><strong>dim</strong> (<em>int</em>) - dimension (rank) of the group</p></li>
<li><p><strong>numvars</strong> (<em>int</em>) - number of variables in the group</p></li>
<li><p><strong>numtimelevels</strong> (<em>int</em>) - declared number of time levels for this group’s variables</p></li>
<li><p><strong>vectorgroup</strong> (<em>int</em>) - 1 if this is a vector group,0 if it’s not</p></li>
<li><p><strong>vectorlength</strong> (<em>int</em>) - vector length of group (i.e. number of vector elements)</p></li>
<li><p><strong>tagstable</strong> (<em>int</em>) - handle to the group’s tags table</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>group_index</strong> (<em>int</em>) – The group index for which the information is desired</p></li>
<li><p><strong>group_data_buffer</strong> (<em>int</em>) – Pointer to a cGroup structure in which the information should be stored.</p></li>
</ul>
</dd>
<dt class="field-odd">Error</dt>
<dd class="field-odd"><p><strong>-1</strong> - group index is invalid.
<strong>-2</strong> - group_data_buffer is NULL.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cGroup</span> <span class="n">group_info</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span> <span class="n">group_index</span> <span class="o">=</span> <span class="n">CCTK_GroupIndex</span><span class="p">(</span><span class="s2">&quot;BSSN_MoL::ADM_BSSN_metric&quot;</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CCTK_GroupData</span><span class="p">(</span><span class="n">group_index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">group_info</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CCTK_VINFO</span><span class="p">(</span><span class="s2">&quot;Dim: </span><span class="si">%d</span><span class="s2">, numvars: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">group_info</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">group_info</span><span class="o">.</span><span class="n">numvars</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_OutputVarAs">
int <code class="sig-name descname">CCTK_OutputVarAs</code><span class="sig-paren">(</span>const <a class="reference internal" href="../API/main.html#c.cGH" title="cGH">cGH</a><em> *cctkGH</em>, const char<em> *variable</em>, const char<em> *alias</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_OutputVarAs" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a single variable as an alias by all I/O methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Discussion</dt>
<dd class="field-odd"><p>If the appropriate file exists the data is appended, otherwise a new file is created. Uses <code class="docutils literal notranslate"><span class="pre">alias</span></code> as the name of the variable for the purpose of constructing a filename.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>cctkGH</strong> – pointer to CCTK grid hierarchy</p></li>
<li><p><strong>variable</strong> (<em>char</em>) – full name of variable to output</p></li>
<li><p><strong>alias</strong> (<em>char</em>) – alias name to base the output filename on</p></li>
</ul>
</dd>
<dt class="field-odd">Result</dt>
<dd class="field-odd"><p><strong>istat</strong> (<em>int</em>) - the number of IO methods which did output of variable</p>
</dd>
<dt class="field-even">Error</dt>
<dd class="field-even"><p><strong>negative</strong> - if no IO methods were registered</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CCTK_OutputVarAs</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span> <span class="s2">&quot;HydroBase::rho&quot;</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_OutputVarAsByMethod">
int <code class="sig-name descname">CCTK_OutputVarAsByMethod</code><span class="sig-paren">(</span>const <a class="reference internal" href="../API/main.html#c.cGH" title="cGH">cGH</a><em> *cctkGH</em>, const char<em> *variable</em>, const char<em> *method</em>, const char<em> *alias</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_OutputVarAsByMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a variable variable using the method method if it is registered. Uses alias as the name of the variable for the purpose of constructing a filename. If the appropriate file exists the data is appended, otherwise a new file is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cctkGH</strong> – pointer to CCTK grid hierarchy</p></li>
<li><p><strong>variable</strong> (<em>char</em>) – full name of variable to output</p></li>
<li><p><strong>method</strong> (<em>char</em>) – method to use for output</p></li>
<li><p><strong>alias</strong> (<em>char</em>) – alias name to base the output filename on</p></li>
</ul>
</dd>
<dt class="field-even">Result</dt>
<dd class="field-even"><p><strong>istat</strong> (<em>int</em>) - zero for success</p>
</dd>
<dt class="field-odd">Error</dt>
<dd class="field-odd"><p><strong>negative</strong> - indicating some error</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="c.CCTK_OutputVarByMethod">
int <code class="sig-name descname">CCTK_OutputVarByMethod</code><span class="sig-paren">(</span>const <a class="reference internal" href="../API/main.html#c.cGH" title="cGH">cGH</a><em> *cctkGH</em>, const char<em> *variable</em>, const char<em> *method</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_OutputVarByMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a variable variable using the IO method method if it is registered. If the appropriate file exists the data is appended, otherwise a new file is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cctkGH</strong> – pointer to CCTK grid hierarchy</p></li>
<li><p><strong>variable</strong> (<em>char</em>) – full name of variable to output</p></li>
<li><p><strong>method</strong> (<em>char</em>) – method to use for output</p></li>
</ul>
</dd>
<dt class="field-even">Result</dt>
<dd class="field-even"><p><strong>istat</strong> (<em>int</em>) - zero for success</p>
</dd>
<dt class="field-odd">Error</dt>
<dd class="field-odd"><p><strong>negative</strong> - indicating some error</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="utility">
<h2>Utility<a class="headerlink" href="#utility" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>API<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.CCTK_isinf">
int <code class="sig-name descname">CCTK_isinf</code><span class="sig-paren">(</span>double<em> x</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_isinf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c.CCTK_isnan">
int <code class="sig-name descname">CCTK_isnan</code><span class="sig-paren">(</span>double<em> x</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CCTK_isnan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="id5">
<h2>Functions<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<div class="section" id="find-closest">
<h3>find_closest<a class="headerlink" href="#find-closest" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;cctk.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;math.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">find_closest</span><span class="p">(</span><span class="k">const</span> <span class="n">cGH</span> <span class="o">*</span><span class="n">cctkGH</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">cctk_lsh</span><span class="p">,</span>
                <span class="k">const</span> <span class="n">CCTK_REAL</span> <span class="o">*</span><span class="n">cctk_delta_space</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ghost</span><span class="p">,</span>
                <span class="n">CCTK_REAL</span> <span class="o">*</span><span class="n">coord</span><span class="p">,</span> <span class="n">CCTK_REAL</span> <span class="n">coord_min</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dir</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">ijk</span><span class="p">,</span> <span class="n">min_i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">CCTK_REAL</span> <span class="n">min</span> <span class="o">=</span> <span class="mf">1.e100</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">ghost</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cctk_lsh</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span><span class="o">-</span><span class="n">ghost</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ijk</span> <span class="o">=</span> <span class="n">CCTK_GFINDEX3D</span><span class="p">(</span><span class="n">cctkGH</span><span class="p">,</span> <span class="p">(</span><span class="n">dir</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="nl">i</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">dir</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">?</span><span class="nl">i</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">dir</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="o">?</span><span class="nl">i</span><span class="p">:</span><span class="mi">0</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">ijk</span><span class="p">]</span> <span class="o">-</span> <span class="n">coord_min</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">min</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">ijk</span><span class="p">]</span> <span class="o">-</span> <span class="n">coord_min</span><span class="p">);</span>
            <span class="n">min_i</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">min_i</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Lorene/main.html" class="btn btn-neutral float-right" title="Lorene" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Guide/main.html" class="btn btn-neutral float-left" title="Thorn Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Yu Liu

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>